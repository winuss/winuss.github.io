<!DOCTYPE html><html lang="en" class="h-full scroll-my-20 scroll-smooth"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/814e03573ee35ccf.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-1c43a9124688bc27.js" crossorigin=""/><script src="/_next/static/chunks/b40443eb-6913cff014374d9b.js" async="" crossorigin=""></script><script src="/_next/static/chunks/848-d93e525e2af78b30.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-a4a2ebec86a29373.js" async="" crossorigin=""></script><script src="/_next/static/chunks/605-9393b79bc12886be.js" async=""></script><script src="/_next/static/chunks/614-02ab0d044823ada6.js" async=""></script><script src="/_next/static/chunks/229-1ed242868e4072e6.js" async=""></script><script src="/_next/static/chunks/323-71aa8ed227954704.js" async=""></script><script src="/_next/static/chunks/637-db3f4f84dff1e805.js" async=""></script><script src="/_next/static/chunks/app/layout-f6bf49daae8218b1.js" async=""></script><script src="/_next/static/chunks/app/(blog)/%5Bslug%5D/page-d29344baf3c6eb9f.js" async=""></script><link rel="preload" href="https://www.googletagmanager.com/gtag/js?id=GTM-M5JW97ZQ" as="script"/><link rel="preload" href="https://www.googletagmanager.com/gtm.js?id=GTM-M5JW97ZQ" as="script"/><title>NLP - 텍스트 분류 (Word2Vec) - | DevTimes</title><meta name="description" content="NLP - 텍스트 분류"/><meta property="og:title" content="NLP - 텍스트 분류 (Word2Vec) - | DevTimes"/><meta property="og:description" content="NLP - 텍스트 분류"/><meta property="og:url" content="https://devtimes.com/nb-text-classification-word2vec"/><meta property="og:image" content="https://devtimes.com/posts/ai/nb-text-classification-word2vec/cover.png"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2019-07-19T00:00:00.000Z"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="NLP - 텍스트 분류 (Word2Vec) - | DevTimes"/><meta name="twitter:description" content="NLP - 텍스트 분류"/><meta name="twitter:image" content="https://devtimes.com/posts/ai/nb-text-classification-word2vec/cover.png"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="518x518"/><link rel="icon" href="/icon.png?8d4a794a4e2a4e0b" type="image/png" sizes="518x518"/><link rel="apple-touch-icon" href="/apple-icon.png?8d4a794a4e2a4e0b" type="image/png" sizes="518x518"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body class="flex min-h-screen flex-col font-pretendard"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><nav style="margin-top:0" class="fixed z-40 flex w-full flex-col items-center justify-center border-b bg-background shadow-sm print:hidden"><div class="mt-1 flex h-[64px] w-full max-w-[1200px] items-center justify-between px-4"><div class="flex items-center font-medium"><a class="rounded-full px-4 py-1 text-center text-sm transition-colors hover:text-primary bg-muted font-medium text-primary" href="/">DEVTIMES</a><a class="rounded-full px-4 py-1 text-center text-sm transition-colors hover:text-primary text-muted-foreground" href="/about">About</a></div><div class="flex gap-3"><a target="_blank" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground aspect-square p-2" href="https://github.com/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-github size-[1.2rem]"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg></a></div></div></nav><main class="mt-[64px] flex flex-1 flex-col"><div class="prose mx-auto w-full max-w-[750px] px-5 dark:prose-invert sm:px-6"><header class="mt-14 text-center"><h1 class="mb-5 text-3xl">NLP - 텍스트 분류 (Word2Vec) -</h1><div class="mb-3 text-base"><a class="font-semibold text-pink-600 no-underline underline-offset-4 hover:underline" href="/ai">Ai</a></div><div class="flex justify-center gap-3 text-sm text-gray-500 dark:text-gray-400"><div class="flex items-center gap-1"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calendar-days w-3.5"><path d="M8 2v4"></path><path d="M16 2v4"></path><rect width="18" height="18" x="3" y="4" rx="2"></rect><path d="M3 10h18"></path><path d="M8 14h.01"></path><path d="M12 14h.01"></path><path d="M16 14h.01"></path><path d="M8 18h.01"></path><path d="M12 18h.01"></path><path d="M16 18h.01"></path></svg><span>2019년 07월 19일</span></div><div class="flex items-center gap-1"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clock3 w-3.5"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16.5 12"></polyline></svg><span>14<!-- -->분</span></div></div><hr class="mt-5"/></header><nav class="xl:hidden"><h2 id="table-of-contents-top">On this page</h2><ul><li class="ml-4 my-0 py-1"><a class="underline-offset-4 hover:text-pink-600" href="#word2vec을-활용한-모델-구현"> word2vec을 활용한 모델 구현</a></li><li class="ml-4 my-0 py-1"><a class="underline-offset-4 hover:text-pink-600" href="#word2vec-백터화"> word2vec 백터화</a></li><li class="ml-4 my-0 py-1"><a class="underline-offset-4 hover:text-pink-600" href="#학습과-검증-데이터셋-분리"> 학습과 검증 데이터셋 분리</a></li><li class="ml-4 my-0 py-1"><a class="underline-offset-4 hover:text-pink-600" href="#모델-선언-및-학습"> 모델 선언 및 학습</a></li><li class="ml-4 my-0 py-1"><a class="underline-offset-4 hover:text-pink-600" href="#검증-데이터셋을-이용한-성능-평가"> 검증 데이터셋을 이용한 성능 평가</a></li><li class="my-0 py-1"><a class="underline-offset-4 hover:text-pink-600" href="#데이터-제출"> 데이터 제출</a></li></ul><hr/></nav><article class="relative"><aside class="not-prose absolute -top-[200px] left-full -mb-[100px] hidden h-[calc(100%+150px)] xl:block "><div class="sticky bottom-0  top-[200px] z-10 ml-[5rem] mt-[200px] w-[200px]"><div class="mb-4 border-l px-4 py-2"><div class="mb-1 font-bold">On this page</div><ul class="text-xs"><li class="ml-4 py-1 transition"><a href="#word2vec을-활용한-모델-구현"> word2vec을 활용한 모델 구현</a></li><li class="ml-4 py-1 transition"><a href="#word2vec-백터화"> word2vec 백터화</a></li><li class="ml-4 py-1 transition"><a href="#학습과-검증-데이터셋-분리"> 학습과 검증 데이터셋 분리</a></li><li class="ml-4 py-1 transition"><a href="#모델-선언-및-학습"> 모델 선언 및 학습</a></li><li class="ml-4 py-1 transition"><a href="#검증-데이터셋을-이용한-성능-평가"> 검증 데이터셋을 이용한 성능 평가</a></li><li class="py-1 transition"><a href="#데이터-제출"> 데이터 제출</a></li></ul></div><div class="flex gap-2"><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 outline outline-input outline-1 bg-background hover:bg-accent hover:text-accent-foreground aspect-square p-2"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-up-to-line "><path d="M5 3h14"></path><path d="m18 13-6-6-6 6"></path><path d="M12 7v14"></path></svg></button><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 outline outline-input outline-1 bg-background hover:bg-accent hover:text-accent-foreground aspect-square p-2"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-message-square-text "><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path><path d="M13 8H7"></path><path d="M17 12H7"></path></svg></button><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 outline outline-input outline-1 bg-background hover:bg-accent hover:text-accent-foreground aspect-square p-2"><span class="sr-only">Copy</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></div></div></aside><p>이번에는 word2vec을 활용하여 모델을 구현 해보자.</p>
<h3 id="word2vec을-활용한-모델-구현">word2vec을 활용한 모델 구현</h3>
<p>word2vec을 활용해 모델을 만들기 위해서는 먼저 각 단어에 대해 word2vec으로 백터화해야 한다.</p>
<p>word2vec의 경우 단어로 표현된 리스트를 입력값으로 넣어야 한다.</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">import</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> pandas </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">as</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> pd</span></span></code></pre></figure>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">DATA_IN_PATH</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> =</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> &#x27;./data_in/&#x27;</span></span>
<span data-line=""><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">TRAIN_CLEAN_DATA</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> =</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> &#x27;train_clean.csv&#x27;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">train_data </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> pd.read_csv(</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">DATA_IN_PATH</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> +</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> TRAIN_CLEAN_DATA</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">reviews </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> list</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(train_data[</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;review&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">])</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">sentiments </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> list</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(train_data[</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;sentiment&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">])</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">sentences </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> []</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">for</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> review </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">in</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> reviews:</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    sentences.append(review.split()) </span><span style="--shiki-dark:#768390;--shiki-light:#6A737D">#review문장내 단어들을 배열로 저장(뜨어쓰기 기준)</span></span></code></pre></figure>
<h3 id="word2vec-백터화">word2vec 백터화</h3>
<p>이제 word2vec 모델 학습을 진행하기 앞서 word2vec 모델의 하이퍼 파라미터를 설정해야 한다.</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D"># 학습 시 필요한 하이퍼 파라미터</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">num_features </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 300</span><span style="--shiki-dark:#768390;--shiki-light:#6A737D">    # 워드 백터 특정값 수</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">min_word_count </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 40</span><span style="--shiki-dark:#768390;--shiki-light:#6A737D">   # 단어에 대한 최소 빈도 수</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">num_workers </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 4</span><span style="--shiki-dark:#768390;--shiki-light:#6A737D">       # 프로세스 개수</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">context </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 10</span><span style="--shiki-dark:#768390;--shiki-light:#6A737D">         # 컨텍스트 윈도우 크기</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">downsampling </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 1e-3</span><span style="--shiki-dark:#768390;--shiki-light:#6A737D">   # 다운 샘플링 비율</span></span></code></pre></figure>
<ul>
<li>num_fratures : 각 단어에 대한 임베딩된 벡터의 차원을 정한다.</li>
<li>min_word_count : 모델에 의미 있는 단어를 가지고 학습하기 위해 적은 빈도 수의 단어들은 학습하지 않는다.</li>
<li>num_workers : 모델에 의미 있는 단어를 가지고 학습하기 위해 적은 빈도 수의 단어들은 학습하지 않는다.</li>
<li>context : word2vec을 수행하기 위한 컨텍스트 윈도우 크기를 지정한다.</li>
<li>downsampling : word2vec 학습을 수행할 때 더 빠른 학습을 위해 정답 단어 라벨에 대한 다운샘플링 비율을 지정한다. (보통 0.001이 좋은 성능을 낸다고 한다)</li>
</ul>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">import</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> logging</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">logging.basicConfig(</span><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">format</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;</span><span style="--shiki-dark:#F47067;--shiki-light:#005CC5">%(asctime)s</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> : </span><span style="--shiki-dark:#F47067;--shiki-light:#005CC5">%(levelname)s</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> : </span><span style="--shiki-dark:#F47067;--shiki-light:#005CC5">%(message)s</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">,\</span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">   level</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">logging.</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">INFO</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span></code></pre></figure>
<p>로깅을 할 떄 format을 위와 같이 지정하고, 로그 수준을 INFO로 하면 word2vec의 학습과정에서 로그 메시지를 양식에 맞게 INFO 수준으로 볼 수 있다.</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">from</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> gensim.models </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">import</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> word2vec</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">print</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&quot;Training model...&quot;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">model </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> word2vec.Word2Vec(sentences,</span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">                        workers</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">num_workers,</span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">                        size</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">num_features,</span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">                        min_count</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">min_word_count,</span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">                        window</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">context,</span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">                        sample</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">downsampling)</span></span></code></pre></figure>
<p>2019-07-12 21:56:43,872 : INFO : collecting all words and their counts<br/>
<!-- -->2019-07-12 21:56:43,872 : INFO : PROGRESS: at sentence #0, processed 0 words, keeping 0 word types</p>
<p>Training model...</p>
<p>2019-07-12 21:56:44,092 : INFO : PROGRESS: at sentence #10000, processed 1205223 words, keeping 51374 word types<br/>
<!-- -->2019-07-12 21:56:44,305 : INFO : PROGRESS: at sentence #20000, processed 2396605 words, keeping 67660 word types<br/>
<!-- -->2019-07-12 21:56:44,406 : INFO : collected 74065 word types from a corpus of 2988089 raw words and 25000 sentences<br/>
<!-- -->2019-07-12 21:56:44,406 : INFO : Loading a fresh vocabulary<br/>
<!-- -->2019-07-12 21:56:44,443 : INFO : min_count=40 retains 8160 unique words (11% of original 74065, drops 65905)<br/>
<!-- -->2019-07-12 21:56:44,443 : INFO : min_count=40 leaves 2627273 word corpus (87% of original 2988089, drops 360816)<br/>
<!-- -->2019-07-12 21:56:44,454 : INFO : deleting the raw counts dictionary of 74065 items<br/>
<!-- -->2019-07-12 21:56:44,469 : INFO : sample=0.001 downsamples 30 most-common words<br/>
<!-- -->2019-07-12 21:56:44,469 : INFO : downsampling leaves estimated 2494384 word corpus (94.9% of prior 2627273)<br/>
<!-- -->2019-07-12 21:56:44,481 : INFO : estimated required memory for 8160 words and 300 dimensions: 23664000 bytes<br/>
<!-- -->2019-07-12 21:56:44,481 : INFO : resetting layer weights<br/>
<!-- -->2019-07-12 21:56:44,577 : INFO : training model with 4 workers on 8160 vocabulary and 300 features, using sg=0 hs=0 sample=0.001 negative=5 window=10<br/>
<!-- -->2019-07-12 21:56:45,578 : INFO : EPOCH 1 - PROGRESS: at 53.88% examples, 1354613 words/s, in_qsize 7, out_qsize 0<br/>
<!-- -->2019-07-12 21:56:46,589 : INFO : EPOCH 1 - PROGRESS: at 97.12% examples, 1208841 words/s, in_qsize 8, out_qsize 0<br/>
<!-- -->2019-07-12 21:56:46,625 : INFO : worker thread finished; awaiting finish of 3 more threads<br/>
<!-- -->2019-07-12 21:56:46,631 : INFO : worker thread finished; awaiting finish of 2 more threads<br/>
<!-- -->2019-07-12 21:56:46,639 : INFO : worker thread finished; awaiting finish of 1 more threads<br/>
<!-- -->2019-07-12 21:56:46,645 : INFO : worker thread finished; awaiting finish of 0 more threads<br/>
<!-- -->2019-07-12 21:56:46,649 : INFO : EPOCH - 1 : training on 2988089 raw words (2494785 effective words) took 2.1s, 1208654 effective words/s<br/>
<!-- -->2019-07-12 21:56:47,643 : INFO : EPOCH 2 - PROGRESS: at 51.68% examples, 1296637 words/s, in_qsize 7, out_qsize 0<br/>
<!-- -->2019-07-12 21:56:48,565 : INFO : worker thread finished; awaiting finish of 3 more threads<br/>
<!-- -->2019-07-12 21:56:48,565 : INFO : worker thread finished; awaiting finish of 2 more threads<br/>
<!-- -->2019-07-12 21:56:48,579 : INFO : worker thread finished; awaiting finish of 1 more threads<br/>
<!-- -->2019-07-12 21:56:48,587 : INFO : worker thread finished; awaiting finish of 0 more threads<br/>
<!-- -->2019-07-12 21:56:48,587 : INFO : EPOCH - 2 : training on 2988089 raw words (2494872 effective words) took 1.9s, 1287927 effective words/s<br/>
<!-- -->2019-07-12 21:56:49,584 : INFO : EPOCH 3 - PROGRESS: at 52.03% examples, 1307272 words/s, in_qsize 7, out_qsize 0<br/>
<!-- -->2019-07-12 21:56:50,495 : INFO : worker thread finished; awaiting finish of 3 more threads<br/>
<!-- -->2019-07-12 21:56:50,504 : INFO : worker thread finished; awaiting finish of 2 more threads<br/>
<!-- -->2019-07-12 21:56:50,504 : INFO : worker thread finished; awaiting finish of 1 more threads<br/>
<!-- -->2019-07-12 21:56:50,513 : INFO : worker thread finished; awaiting finish of 0 more threads<br/>
<!-- -->2019-07-12 21:56:50,513 : INFO : EPOCH - 3 : training on 2988089 raw words (2494507 effective words) took 1.9s, 1297134 effective words/s<br/>
<!-- -->2019-07-12 21:56:51,508 : INFO : EPOCH 4 - PROGRESS: at 52.60% examples, 1319590 words/s, in_qsize 7, out_qsize 0<br/>
<!-- -->2019-07-12 21:56:52,421 : INFO : worker thread finished; awaiting finish of 3 more threads<br/>
<!-- -->2019-07-12 21:56:52,438 : INFO : worker thread finished; awaiting finish of 2 more threads<br/>
<!-- -->2019-07-12 21:56:52,438 : INFO : worker thread finished; awaiting finish of 1 more threads<br/>
<!-- -->2019-07-12 21:56:52,444 : INFO : worker thread finished; awaiting finish of 0 more threads<br/>
<!-- -->2019-07-12 21:56:52,444 : INFO : EPOCH - 4 : training on 2988089 raw words (2494292 effective words) took 1.9s, 1293999 effective words/s<br/>
<!-- -->2019-07-12 21:56:53,445 : INFO : EPOCH 5 - PROGRESS: at 54.20% examples, 1360524 words/s, in_qsize 7, out_qsize 0<br/>
<!-- -->2019-07-12 21:56:54,212 : INFO : worker thread finished; awaiting finish of 3 more threads<br/>
<!-- -->2019-07-12 21:56:54,228 : INFO : worker thread finished; awaiting finish of 2 more threads<br/>
<!-- -->2019-07-12 21:56:54,235 : INFO : worker thread finished; awaiting finish of 1 more threads<br/>
<!-- -->2019-07-12 21:56:54,241 : INFO : worker thread finished; awaiting finish of 0 more threads<br/>
<!-- -->2019-07-12 21:56:54,242 : INFO : EPOCH - 5 : training on 2988089 raw words (2494012 effective words) took 1.8s, 1390220 effective words/s<br/>
<!-- -->2019-07-12 21:56:54,242 : INFO : training on a 14940445 raw words (12472468 effective words) took 9.7s, 1291189 effective words/s</p>
<p>word2vec으로 학습시킨 모델의 경우 모델을 따로 저장해두면 이후 다시 사용할수 있기 때문에 저장해두자</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D"># 모델의 하이퍼파라미터를 설정한 내용을 모델 이름에 담는다면 나중에 참고하기 용이하다.</span></span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D"># 모델을 저장하면 Word2Vec.load()를 통해 다시 사용할 수 있다.</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">model_name </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> &quot;300features_40minwords_10context&quot;</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">model.save(model_name)</span></span></code></pre></figure>
<p>2019-07-12 22:00:40,807 : INFO : saving Word2Vec object under 300features_40minwords_10context, separately None<br/>
<!-- -->2019-07-12 22:00:40,807 : INFO : not storing attribute vectors_norm<br/>
<!-- -->2019-07-12 22:00:40,807 : INFO : not storing attribute cum_table<br/>
<!-- -->C:\Users\nicey.conda\envs\nlp\lib\site-packages\smart_open\smart_open_lib.py:398: UserWarning: This function is deprecated, use smart_open.open instead. See the migration notes for details: <a target="_blank" href="https://github.com/RaRe-Technologies/smart_open/blob/master/README.rst#migrating-to-the-new-open-function" class="break-words text-pink-600 no-underline underline-offset-4 hover:underline">https://github.com/RaRe-Technologies/smart_open/blob/master/README.rst#migrating-to-the-new-open-function</a><br/>
<!-- -->&#x27;See the migration notes for details: %s&#x27; % _MIGRATION_NOTES_URL<br/>
<!-- -->2019-07-12 22:00:41,229 : INFO : saved 300features_40minwords_10context</p>
<p>에제 만들어진 word2vec 모델을 활용해 선형 회귀 모델을 학습해보자. 우선 학습을 위해 하나의 리뷰를 같은 형태의 입력값으로 만들어야 한다. 지금은 word2vec 모델에서 각 단어가 벡터로 표현돼 있다. 그리고 리뷰마다 단어의 개수가 모두 다르기 때문에 입력값을 하나으 형태로 만들어야 한다. 가장 단순한 방법은 문장에 있는 모든 단어의 벡터값에 대해 평균을 내서 리뷰 하나당 하나의 벡터로 만드는 방법이 있다.</p>
<p>그럼 하나의 리뷰에 대해 전체 단어의 평균값을 계산하는 함수를 구현하자</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">import</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> numpy </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">as</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> np</span></span></code></pre></figure>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">def</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1"> get_features</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(words, model, num_features):</span></span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">    # 출력 벡터 초기화</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    feature_vector </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> np.zeros((num_features), </span><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">dtype</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">np.float32)</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    </span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    num_words </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 0</span></span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">    # 어휘 사전 준비</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    index2word_set </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> set</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(model.wv.index2word)</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    </span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">    for</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> w </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">in</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> words:</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">        if</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> w </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">in</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> index2word_set:</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">            num_words </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 1</span></span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">            # 사전에 해당하는 단어에 대해 단어 벡터를 더함</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">            feature_vector </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> np.add(feature_vector, model[w])</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">            </span></span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D">    # 문장의 단어 수만큼 나누어 단어 벡터의 평균값을 문장 벡터로 함</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    feature_vector </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> np.divide(feature_vector, num_words)</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">    return</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> feature_vector</span></span></code></pre></figure>
<ul>
<li>words : 단어의 모음인 하나의 리뷰가 들어간다.</li>
<li>model : word2vec 모델을 넣는 공이며, 우리가 학습한 word2vec 모델이 들어간다.</li>
<li>num_features : word2vec으로 임베딩할 때 정했던 벡터의 차원 수를 뜻한다.</li>
</ul>
<p>하나의 벡터를 만드는 과정을 빠르게 하기 위해 np.zeros를 사용해 미리 모두 0값을 가지는 벡터를 만든다. 그리고 문장의 단어가 모델 단어사전에 속하는지 보기 위해 model.wv.index2word를 set객체로 생성해서 index2word_set 변수에 할당한다. 다음 반복문을 통해 리뷰를 구성하는 단어에 대해 임베딩된 벡터가 있는 단어 벡터의 합을 구하고 사용한 단어의 전체 개수로 나누어 평균 벡터의 값을 구한다.</p>
<p>문장에 특징값을 만들 수 있는 함수를 구현했다면 이제 앞에서 정의한 함수를 사용해 전체 리뷰에 대해 각 리뷰의 평균 벡터를 구하는 함수를 정의하자</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">def</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1"> get_dataset</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(reviews, model, num_features):</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    dataset </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> list</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">()</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    </span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">    for</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> s </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">in</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> reviews:</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">        dataset.append(get_features(s, model, num_features))</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">        </span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    reviewFeatureVecs </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> np.stack(dataset)</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">    return</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> reviewFeatureVecs</span></span></code></pre></figure>
<ul>
<li>reviews : 학습 데이터인 전체 리뷰 데이터를 입력</li>
<li>model : word2vec 모델을 입력</li>
<li>num_features : word2vec으로 임베딩할 때 정했던 벡터의 차원 수</li>
</ul>
<p>전체 리뷰에 대한 평균 벡터를 담을 0으로 채워진 numpy 배열을 미리 만든다. 배열은 2차원, 배열의 행에는 각 문장에 대한 길이, 열에는 평균 벡터의 차원수 즉 크기를 입력. 그리고 각 리뷰에 대해 반복문을 돌면서 각 리뷰에 대해 특징 값을 만든다.</p>
<p>구현한 함수를 사용해 실제 학습에 사용될 입력값을 만들어 보자.</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">test_data_vecs </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> get_dataset(sentences, model, num_features)</span></span></code></pre></figure>
<p>C:\Users\nicey.conda\envs\nlp\lib\site-packages\ipykernel_launcher.py:13: DeprecationWarning: Call to deprecated <code>__getitem__</code> (Method will be removed in 4.0.0, use self.wv.<strong>getitem</strong>() instead).<br/>
<!-- -->del sys.path[0]</p>
<h3 id="학습과-검증-데이터셋-분리">학습과 검증 데이터셋 분리</h3>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">from</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> sklearn.model_selection </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">import</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> train_test_split</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">import</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> numpy </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">as</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> np</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">X </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> test_data_vecs</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">y </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> np.array(sentiments)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">RANDOM_SEED</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> =</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 42</span></span>
<span data-line=""><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">TEST_SPLIT</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> =</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 0.2</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">X_train, X_test, y_train, y_test </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> train_test_split(X, y, </span><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">test_size</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">TEST_SPLIT</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, </span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">                                                    random_state</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">RANDOM_SEED</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span>
<span data-line=""> </span></code></pre></figure>
<h3 id="모델-선언-및-학습">모델 선언 및 학습</h3>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">from</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> sklearn.linear_model </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">import</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> LogisticRegression</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">lgs </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> LogisticRegression(</span><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">class_weight</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;balanced&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">lgs.fit(X_train, y_train)</span></span></code></pre></figure>
<p>C:\Users\nicey.conda\envs\nlp\lib\site-packages\sklearn\linear_model\logistic.py:432: FutureWarning: Default solver will be changed to &#x27;lbfgs&#x27; in 0.22. Specify a solver to silence this warning.<br/>
<!-- -->FutureWarning)</p>
<p>LogisticRegression(C=1.0, class_weight=&#x27;balanced&#x27;, dual=False,<br/>
<!-- -->fit_intercept=True, intercept_scaling=1, l1_ratio=None,<br/>
<!-- -->max_iter=100, multi_class=&#x27;warn&#x27;, n_jobs=None, penalty=&#x27;l2&#x27;,<br/>
<!-- -->random_state=None, solver=&#x27;warn&#x27;, tol=0.0001, verbose=0,<br/>
<!-- -->warm_start=False)</p>
<p>class_weight을 <code>balanced</code>로 설정했다. 이는 각 라벨에 대해 균형있게 학습하기 위함이다.</p>
<h3 id="검증-데이터셋을-이용한-성능-평가">검증 데이터셋을 이용한 성능 평가</h3>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">predicted </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> lgs.predict(X_test)</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">from</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> sklearn </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">import</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> metrics</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">fpr, tpr, _ </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> metrics.roc_curve(y_test, (lgs.predict_proba(X_test)[:, </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">1</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">]))</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">auc </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> metrics.auc(fpr, tpr)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">print</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&quot;------------&quot;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span>
<span data-line=""><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">print</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&quot;Accuracy: </span><span style="--shiki-dark:#F47067;--shiki-light:#005CC5">%f</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&quot;</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> %</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> lgs.score(X_test, y_test))  </span><span style="--shiki-dark:#768390;--shiki-light:#6A737D">#checking the accuracy</span></span>
<span data-line=""><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">print</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&quot;Precision: </span><span style="--shiki-dark:#F47067;--shiki-light:#005CC5">%f</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&quot;</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> %</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> metrics.precision_score(y_test, predicted))</span></span>
<span data-line=""><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">print</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&quot;Recall: </span><span style="--shiki-dark:#F47067;--shiki-light:#005CC5">%f</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&quot;</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> %</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> metrics.recall_score(y_test, predicted))</span></span>
<span data-line=""><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">print</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&quot;F1-Score: </span><span style="--shiki-dark:#F47067;--shiki-light:#005CC5">%f</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&quot;</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> %</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> metrics.f1_score(y_test, predicted))</span></span>
<span data-line=""><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">print</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&quot;AUC: </span><span style="--shiki-dark:#F47067;--shiki-light:#005CC5">%f</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&quot;</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> %</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> auc)</span></span></code></pre></figure>
<hr/>
<p>Accuracy: 0.874200<br/>
<!-- -->Precision: 0.869141<br/>
<!-- -->Recall: 0.883287<br/>
<!-- -->F1-Score: 0.876157<br/>
<!-- -->AUC: 0.940927</p>
<p>학습 결과를 확인해 보면 TF-IDF를 사용해서 학습한 것보다 상대적으로 성능이 조금 떨어지는 것을 볼 수 있다. word2vec이 단어 간의 유사도를 보는 관점에서는 분명히 효과적일 수는 있지만 항상 좋은 성능을 보장하지는 않는다는 점을 알 수 있다.</p>
<h2 id="데이터-제출">데이터 제출</h2>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">TEST_CLEAN_DATA</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> =</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> &#x27;test_clean.csv&#x27;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">test_data </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> pd.read_csv(</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">DATA_IN_PATH</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> +</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> TEST_CLEAN_DATA</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">test_review </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> list</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(test_data[</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;review&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">])</span></span></code></pre></figure>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">test_data.head(</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">5</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span></code></pre></figure>
<table><thead><tr><th></th><th>review</th><th>id</th></tr></thead><tbody><tr><td>0</td><td>naturally film main themes mortality nostalgia...</td><td>&quot;12311_10&quot;</td></tr><tr><td>1</td><td>movie disaster within disaster film full great...</td><td>&quot;8348_2&quot;</td></tr><tr><td>2</td><td>movie kids saw tonight child loved one point k...</td><td>&quot;5828_4&quot;</td></tr><tr><td>3</td><td>afraid dark left impression several different ...</td><td>&quot;7186_2&quot;</td></tr><tr><td>4</td><td>accurate depiction small time mob life filmed ...</td><td>&quot;12128_7&quot;</td></tr></tbody></table>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">test_sentences </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> list</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">()</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">for</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> review </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">in</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> test_review:</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    test_sentences.append(review.split())</span></span></code></pre></figure>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">test_data_vecs </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> get_dataset(test_sentences, model, num_features)</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">test_predicted </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> lgs.predict(test_data_vecs)</span></span></code></pre></figure>
<p>C:\Users\nicey.conda\envs\nlp\lib\site-packages\ipykernel_launcher.py:13: DeprecationWarning: Call to deprecated <code>__getitem__</code> (Method will be removed in 4.0.0, use self.wv.<strong>getitem</strong>() instead).<br/>
<!-- -->del sys.path[0]</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">import</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> os</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">DATA_OUT_PATH</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> =</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> &#x27;./data_out/&#x27;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">if</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> not</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> os.path.exists(</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">DATA_OUT_PATH</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">):</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">    os.makedirs(</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">DATA_OUT_PATH</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">ids </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> list</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(test_data[</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;id&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">])</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">answer_dataset </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> pd.DataFrame({</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;id&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">: ids, </span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;sentiment&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">: test_predicted})</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">answer_dataset.to_csv(</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">DATA_OUT_PATH</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> +</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> &#x27;lgs_w2v_answer.csv&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, </span><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">index</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">False</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, </span><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">quoting</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">3</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span></code></pre></figure></article><hr/><section></section><div class="group fixed bottom-4 right-4 xl:hidden"><div class="group relative flex flex-col-reverse"><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 outline outline-input outline-1 bg-background hover:bg-accent hover:text-accent-foreground aspect-square p-2 absolute bottom-0 right-0 z-10 transition"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bolt "><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><circle cx="12" cy="12" r="4"></circle></svg></button><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 outline outline-input outline-1 bg-background hover:bg-accent hover:text-accent-foreground aspect-square p-2 absolute bottom-0 right-0 transition"><span class="sr-only">Copy</span><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 outline outline-input outline-1 bg-background hover:bg-accent hover:text-accent-foreground aspect-square p-2 absolute bottom-0 right-0 transition"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-message-square-text "><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path><path d="M13 8H7"></path><path d="M17 12H7"></path></svg></button><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 outline outline-input outline-1 bg-background hover:bg-accent hover:text-accent-foreground aspect-square p-2 absolute bottom-0 right-0 transition"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-up-to-line "><path d="M5 3h14"></path><path d="m18 13-6-6-6 6"></path><path d="M12 7v14"></path></svg></button></div></div></div></main><footer class="mb-16 mt-20 flex flex-col items-center justify-center gap-4 text-center print:hidden"><div class="flex justify-center gap-4"><a target="_blank" href="https://github.com/"><svg fill="currentColor" viewBox="0 0 16 16" height="30" width="30" class="fill-foreground transition hover:fill-pink-600"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a><a target="_blank" href="https://www.linkedin.com/in/"><svg viewBox="0 0 24 24" fill="currentColor" height="30" width="30" class="fill-foreground transition hover:fill-pink-600"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a></div><div>© 2024. <span class="font-semibold">Devtimes</span> all rights reserved.</div></footer><div role="region" aria-label="Notifications (F8)" tabindex="-1" style="pointer-events:none"><ol tabindex="-1" class="fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[300px]"></ol></div><!--$!--><template data-dgst="BAILOUT_TO_CLIENT_SIDE_RENDERING"></template><!--/$--><script src="/_next/static/chunks/webpack-1c43a9124688bc27.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/814e03573ee35ccf.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:I[2386,[],\"\"]\n6:I[9261,[],\"\"]\n8:I[6675,[],\"\"]\n9:I[8390,[\"605\",\"static/chunks/605-9393b79bc12886be.js\",\"614\",\"static/chunks/614-02ab0d044823ada6.js\",\"229\",\"static/chunks/229-1ed242868e4072e6.js\",\"323\",\"static/chunks/323-71aa8ed227954704.js\",\"637\",\"static/chunks/637-db3f4f84dff1e805.js\",\"185\",\"static/chunks/app/layout-f6bf49daae8218b1.js\"],\"ThemeProvider\"]\na:I[7083,[\"605\",\"static/chunks/605-9393b79bc12886be.js\",\"614\",\"static/chunks/614-02ab0d044823ada6.js\",\"229\",\"static/chunks/229-1ed242868e4072e6.js\",\"323\""])</script><script>self.__next_f.push([1,",\"static/chunks/323-71aa8ed227954704.js\",\"637\",\"static/chunks/637-db3f4f84dff1e805.js\",\"185\",\"static/chunks/app/layout-f6bf49daae8218b1.js\"],\"Header\"]\nb:I[9605,[\"605\",\"static/chunks/605-9393b79bc12886be.js\",\"614\",\"static/chunks/614-02ab0d044823ada6.js\",\"206\",\"static/chunks/app/(blog)/%5Bslug%5D/page-d29344baf3c6eb9f.js\"],\"\"]\nc:I[3760,[\"605\",\"static/chunks/605-9393b79bc12886be.js\",\"614\",\"static/chunks/614-02ab0d044823ada6.js\",\"229\",\"static/chunks/229-1ed242868e4072e6.js\",\"323\",\"static/chunks/323-71aa8ed22795"])</script><script>self.__next_f.push([1,"4704.js\",\"637\",\"static/chunks/637-db3f4f84dff1e805.js\",\"185\",\"static/chunks/app/layout-f6bf49daae8218b1.js\"],\"Toaster\"]\nd:I[3542,[\"605\",\"static/chunks/605-9393b79bc12886be.js\",\"614\",\"static/chunks/614-02ab0d044823ada6.js\",\"229\",\"static/chunks/229-1ed242868e4072e6.js\",\"323\",\"static/chunks/323-71aa8ed227954704.js\",\"637\",\"static/chunks/637-db3f4f84dff1e805.js\",\"185\",\"static/chunks/app/layout-f6bf49daae8218b1.js\"],\"Analytics\"]\ne:I[6693,[\"605\",\"static/chunks/605-9393b79bc12886be.js\",\"614\",\"static/chunks/614-02ab"])</script><script>self.__next_f.push([1,"0d044823ada6.js\",\"229\",\"static/chunks/229-1ed242868e4072e6.js\",\"323\",\"static/chunks/323-71aa8ed227954704.js\",\"637\",\"static/chunks/637-db3f4f84dff1e805.js\",\"185\",\"static/chunks/app/layout-f6bf49daae8218b1.js\"],\"SpeedInsights\"]\nf:I[450,[\"605\",\"static/chunks/605-9393b79bc12886be.js\",\"614\",\"static/chunks/614-02ab0d044823ada6.js\",\"229\",\"static/chunks/229-1ed242868e4072e6.js\",\"323\",\"static/chunks/323-71aa8ed227954704.js\",\"637\",\"static/chunks/637-db3f4f84dff1e805.js\",\"185\",\"static/chunks/app/layout-f6bf49daae8218b"])</script><script>self.__next_f.push([1,"1.js\"],\"GoogleAnalytics\"]\n10:I[8806,[\"605\",\"static/chunks/605-9393b79bc12886be.js\",\"614\",\"static/chunks/614-02ab0d044823ada6.js\",\"229\",\"static/chunks/229-1ed242868e4072e6.js\",\"323\",\"static/chunks/323-71aa8ed227954704.js\",\"637\",\"static/chunks/637-db3f4f84dff1e805.js\",\"185\",\"static/chunks/app/layout-f6bf49daae8218b1.js\"],\"GoogleTagManager\"]\n12:I[5404,[],\"\"]\n7:[\"slug\",\"nb-text-classification-word2vec\",\"d\"]\n13:[]\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/814e03573ee35ccf.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L3\",null,{\"buildId\":\"7s8h52OZKL_YWJFhhEO3A\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/nb-text-classification-word2vec\",\"initialTree\":[\"\",{\"children\":[\"(blog)\",{\"children\":[[\"slug\",\"nb-text-classification-word2vec\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"nb-text-classification-word2vec\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"(blog)\",{\"children\":[[\"slug\",\"nb-text-classification-word2vec\",\"d\"],{\"children\":[\"__PAGE__\",{},[\"$L4\",\"$L5\",null]]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(blog)\",\"children\",\"$7\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(blog)\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[null,[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"h-full scroll-my-20 scroll-smooth\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"flex min-h-screen flex-col font-pretendard\",\"children\":[[\"$\",\"$L9\",null,{\"children\":[[\"$\",\"$La\",null,{}],[\"$\",\"main\",null,{\"className\":\"mt-[64px] flex flex-1 flex-col\",\"children\":[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"div\",null,{\"className\":\"grid flex-1 place-content-center text-center\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"mb-4 text-2xl font-bold\",\"children\":\"Not Found\"}],[\"$\",\"p\",null,{\"className\":\"mb-8 text-lg\",\"children\":\"찾을 수 없는 페이지입니다.\"}],[\"$\",\"$Lb\",null,{\"href\":\"/\",\"children\":\"홈으로\",\"className\":\"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 py-2 mx-auto w-fit px-10\"}]]}],\"notFoundStyles\":[],\"styles\":null}]}],[\"$\",\"footer\",null,{\"className\":\"mb-16 mt-20 flex flex-col items-center justify-center gap-4 text-center print:hidden\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex justify-center gap-4\",\"children\":[[\"$\",\"$Lb\",null,{\"href\":\"https://github.com/\",\"target\":\"_blank\",\"children\":[\"$\",\"svg\",null,{\"fill\":\"currentColor\",\"viewBox\":\"0 0 16 16\",\"height\":30,\"width\":30,\"className\":\"fill-foreground transition hover:fill-pink-600\",\"children\":[\"$\",\"path\",null,{\"d\":\"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0016 8c0-4.42-3.58-8-8-8z\"}]}]}],[\"$\",\"$Lb\",null,{\"href\":\"https://www.linkedin.com/in/\",\"target\":\"_blank\",\"children\":[\"$\",\"svg\",null,{\"viewBox\":\"0 0 24 24\",\"fill\":\"currentColor\",\"height\":30,\"width\":30,\"className\":\"fill-foreground transition hover:fill-pink-600\",\"children\":[\"$\",\"path\",null,{\"d\":\"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z\"}]}]}]]}],[\"$\",\"div\",null,{\"children\":[\"© 2024. \",[\"$\",\"span\",null,{\"className\":\"font-semibold\",\"children\":\"Devtimes\"}],\" all rights reserved.\"]}]]}]]}],[\"$\",\"$Lc\",null,{}],[\"$\",\"$Ld\",null,{}],[\"$\",\"$Le\",null,{}],[\"$\",\"$Lf\",null,{\"gaId\":\"GTM-M5JW97ZQ\"}],[\"$\",\"$L10\",null,{\"gtmId\":\"GTM-M5JW97ZQ\"}]]}]}],null]],\"initialHead\":[false,\"$L11\"],\"globalErrorComponent\":\"$12\",\"missingSlots\":\"$W13\"}]]\n"])</script><script>self.__next_f.push([1,"14:I[2465,[\"605\",\"static/chunks/605-9393b79bc12886be.js\",\"614\",\"static/chunks/614-02ab0d044823ada6.js\",\"206\",\"static/chunks/app/(blog)/%5Bslug%5D/page-d29344baf3c6eb9f.js\"],\"\"]\n16:I[3574,[\"605\",\"static/chunks/605-9393b79bc12886be.js\",\"614\",\"static/chunks/614-02ab0d044823ada6.js\",\"206\",\"static/chunks/app/(blog)/%5Bslug%5D/page-d29344baf3c6eb9f.js\"],\"\"]\n17:I[938,[\"605\",\"static/chunks/605-9393b79bc12886be.js\",\"614\",\"static/chunks/614-02ab0d044823ada6.js\",\"206\",\"static/chunks/app/(blog)/%5Bslug%5D/page-d29344ba"])</script><script>self.__next_f.push([1,"f3c6eb9f.js\"],\"\"]\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"className\":\"prose mx-auto w-full max-w-[750px] px-5 dark:prose-invert sm:px-6\",\"children\":[[\"$\",\"header\",null,{\"className\":\"mt-14 text-center\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"mb-5 text-3xl\",\"children\":\"NLP - 텍스트 분류 (Word2Vec) -\"}],[\"$\",\"div\",null,{\"className\":\"mb-3 text-base\",\"children\":[\"$\",\"$Lb\",null,{\"href\":\"/ai\",\"className\":\"font-semibold text-pink-600 no-underline underline-offset-4 hover:underline\",\"children\":\"Ai\"}]}],[\"$\",\"div\",null,{\"className\":\"flex justify-center gap-3 text-sm text-gray-500 dark:text-gray-400\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex items-center gap-1\",\"children\":[[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-calendar-days w-3.5\",\"children\":[[\"$\",\"path\",\"1cmpym\",{\"d\":\"M8 2v4\"}],[\"$\",\"path\",\"4m81vk\",{\"d\":\"M16 2v4\"}],[\"$\",\"rect\",\"1hopcy\",{\"width\":\"18\",\"height\":\"18\",\"x\":\"3\",\"y\":\"4\",\"rx\":\"2\"}],[\"$\",\"path\",\"8toen8\",{\"d\":\"M3 10h18\"}],[\"$\",\"path\",\"6423bh\",{\"d\":\"M8 14h.01\"}],[\"$\",\"path\",\"1etili\",{\"d\":\"M12 14h.01\"}],[\"$\",\"path\",\"1gbofw\",{\"d\":\"M16 14h.01\"}],[\"$\",\"path\",\"lrp35t\",{\"d\":\"M8 18h.01\"}],[\"$\",\"path\",\"mhygvu\",{\"d\":\"M12 18h.01\"}],[\"$\",\"path\",\"kzsmim\",{\"d\":\"M16 18h.01\"}],\"$undefined\"]}],[\"$\",\"span\",null,{\"children\":\"2019년 07월 19일\"}]]}],[\"$\",\"div\",null,{\"className\":\"flex items-center gap-1\",\"children\":[[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-clock3 w-3.5\",\"children\":[[\"$\",\"circle\",\"1mglay\",{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}],[\"$\",\"polyline\",\"1aq6pp\",{\"points\":\"12 6 12 12 16.5 12\"}],\"$undefined\"]}],[\"$\",\"span\",null,{\"children\":[14,\"분\"]}]]}]]}],[\"$\",\"hr\",null,{\"className\":\"mt-5\"}]]}],[\"$\",\"nav\",null,{\"className\":\"xl:hidden\",\"children\":[[\"$\",\"h2\",null,{\"id\":\"table-of-contents-top\",\"children\":\"On this page\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",\"#word2vec을-활용한-모델-구현\",{\"className\":\"ml-4 my-0 py-1\",\"children\":[\"$\",\"$Lb\",null,{\"href\":\"#word2vec을-활용한-모델-구현\",\"className\":\"underline-offset-4 hover:text-pink-600\",\"children\":\" word2vec을 활용한 모델 구현\"}]}],[\"$\",\"li\",\"#word2vec-백터화\",{\"className\":\"ml-4 my-0 py-1\",\"children\":[\"$\",\"$Lb\",null,{\"href\":\"#word2vec-백터화\",\"className\":\"underline-offset-4 hover:text-pink-600\",\"children\":\" word2vec 백터화\"}]}],[\"$\",\"li\",\"#학습과-검증-데이터셋-분리\",{\"className\":\"ml-4 my-0 py-1\",\"children\":[\"$\",\"$Lb\",null,{\"href\":\"#학습과-검증-데이터셋-분리\",\"className\":\"underline-offset-4 hover:text-pink-600\",\"children\":\" 학습과 검증 데이터셋 분리\"}]}],[\"$\",\"li\",\"#모델-선언-및-학습\",{\"className\":\"ml-4 my-0 py-1\",\"children\":[\"$\",\"$Lb\",null,{\"href\":\"#모델-선언-및-학습\",\"className\":\"underline-offset-4 hover:text-pink-600\",\"children\":\" 모델 선언 및 학습\"}]}],[\"$\",\"li\",\"#검증-데이터셋을-이용한-성능-평가\",{\"className\":\"ml-4 my-0 py-1\",\"children\":[\"$\",\"$Lb\",null,{\"href\":\"#검증-데이터셋을-이용한-성능-평가\",\"className\":\"underline-offset-4 hover:text-pink-600\",\"children\":\" 검증 데이터셋을 이용한 성능 평가\"}]}],[\"$\",\"li\",\"#데이터-제출\",{\"className\":\"my-0 py-1\",\"children\":[\"$\",\"$Lb\",null,{\"href\":\"#데이터-제출\",\"className\":\"underline-offset-4 hover:text-pink-600\",\"children\":\" 데이터 제출\"}]}]]}],[\"$\",\"hr\",null,{}]]}],[\"$\",\"article\",null,{\"className\":\"relative\",\"children\":[[\"$\",\"$L14\",null,{\"toc\":[{\"text\":\" word2vec을 활용한 모델 구현\",\"link\":\"#word2vec을-활용한-모델-구현\",\"indent\":1},{\"text\":\" word2vec 백터화\",\"link\":\"#word2vec-백터화\",\"indent\":1},{\"text\":\" 학습과 검증 데이터셋 분리\",\"link\":\"#학습과-검증-데이터셋-분리\",\"indent\":1},{\"text\":\" 모델 선언 및 학습\",\"link\":\"#모델-선언-및-학습\",\"indent\":1},{\"text\":\" 검증 데이터셋을 이용한 성능 평가\",\"link\":\"#검증-데이터셋을-이용한-성능-평가\",\"indent\":1},{\"text\":\" 데이터 제출\",\"link\":\"#데이터-제출\",\"indent\":0}]}],\"$L15\"]}],[\"$\",\"hr\",null,{}],[\"$\",\"$L16\",null,{}],[\"$\",\"$L17\",null,{}]]}]\n"])</script><script>self.__next_f.push([1,"11:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"NLP - 텍스트 분류 (Word2Vec) - | DevTimes\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"NLP - 텍스트 분류\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:title\",\"content\":\"NLP - 텍스트 분류 (Word2Vec) - | DevTimes\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:description\",\"content\":\"NLP - 텍스트 분류\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:url\",\"content\":\"https://devtimes.com/nb-text-classification-word2vec\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:image\",\"content\":\"https://devtimes.com/posts/ai/nb-text-classification-word2vec/cover.png\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"9\",{\"property\":\"article:published_time\",\"content\":\"2019-07-19T00:00:00.000Z\"}],[\"$\",\"meta\",\"10\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:title\",\"content\":\"NLP - 텍스트 분류 (Word2Vec) - | DevTimes\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:description\",\"content\":\"NLP - 텍스트 분류\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:image\",\"content\":\"https://devtimes.com/posts/ai/nb-text-classification-word2vec/cover.png\"}],[\"$\",\"link\",\"14\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"518x518\"}],[\"$\",\"link\",\"15\",{\"rel\":\"icon\",\"href\":\"/icon.png?8d4a794a4e2a4e0b\",\"type\":\"image/png\",\"sizes\":\"518x518\"}],[\"$\",\"link\",\"16\",{\"rel\":\"apple-touch-icon\",\"href\":\"/apple-icon.png?8d4a794a4e2a4e0b\",\"type\":\"image/png\",\"sizes\":\"518x518\"}]]\n"])</script><script>self.__next_f.push([1,"4:null\n"])</script><script>self.__next_f.push([1,"15:[[\"$\",\"p\",null,{\"children\":\"이번에는 word2vec을 활용하여 모델을 구현 해보자.\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"word2vec을-활용한-모델-구현\",\"children\":\"word2vec을 활용한 모델 구현\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"word2vec을 활용해 모델을 만들기 위해서는 먼저 각 단어에 대해 word2vec으로 백터화해야 한다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"word2vec의 경우 단어로 표현된 리스트를 입력값으로 넣어야 한다.\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" pandas \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" pd\"}]]}]}]}]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"DATA_IN_PATH\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\" './data_in/'\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"TRAIN_CLEAN_DATA\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\" 'train_clean.csv'\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"train_data \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" pd.read_csv(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"DATA_IN_PATH\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\" +\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" TRAIN_CLEAN_DATA\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"reviews \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" list\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(train_data[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'review'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"])\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"sentiments \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" list\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(train_data[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'sentiment'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"])\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"sentences \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" []\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"for\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" review \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" reviews:\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"    sentences.append(review.split()) \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#768390\",\"--shiki-light\":\"#6A737D\"},\"children\":\"#review문장내 단어들을 배열로 저장(뜨어쓰기 기준)\"}]]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"word2vec-백터화\",\"children\":\"word2vec 백터화\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이제 word2vec 모델 학습을 진행하기 앞서 word2vec 모델의 하이퍼 파라미터를 설정해야 한다.\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#768390\",\"--shiki-light\":\"#6A737D\"},\"children\":\"# 학습 시 필요한 하이퍼 파라미터\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"num_features \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" 300\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#768390\",\"--shiki-light\":\"#6A737D\"},\"children\":\"    # 워드 백터 특정값 수\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"min_word_count \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" 40\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#768390\",\"--shiki-light\":\"#6A737D\"},\"children\":\"   # 단어에 대한 최소 빈도 수\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"num_workers \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" 4\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#768390\",\"--shiki-light\":\"#6A737D\"},\"children\":\"       # 프로세스 개수\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"context \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" 10\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#768390\",\"--shiki-light\":\"#6A737D\"},\"children\":\"         # 컨텍스트 윈도우 크기\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"downsampling \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" 1e-3\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#768390\",\"--shiki-light\":\"#6A737D\"},\"children\":\"   # 다운 샘플링 비율\"}]]}]]}]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"num_fratures : 각 단어에 대한 임베딩된 벡터의 차원을 정한다.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"min_word_count : 모델에 의미 있는 단어를 가지고 학습하기 위해 적은 빈도 수의 단어들은 학습하지 않는다.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"num_workers : 모델에 의미 있는 단어를 가지고 학습하기 위해 적은 빈도 수의 단어들은 학습하지 않는다.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"context : word2vec을 수행하기 위한 컨텍스트 윈도우 크기를 지정한다.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"downsampling : word2vec 학습을 수행할 때 더 빠른 학습을 위해 정답 단어 라벨에 대한 다운샘플링 비율을 지정한다. (보통 0.001이 좋은 성능을 낸다고 한다)\"}],\"\\n\"]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" logging\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"logging.basicConfig(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"format\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#005CC5\"},\"children\":\"%(asctime)s\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\" : \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#005CC5\"},\"children\":\"%(levelname)s\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\" : \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#005CC5\"},\"children\":\"%(message)s\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\",\\\\\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"   level\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"logging.\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"INFO\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"로깅을 할 떄 format을 위와 같이 지정하고, 로그 수준을 INFO로 하면 word2vec의 학습과정에서 로그 메시지를 양식에 맞게 INFO 수준으로 볼 수 있다.\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" gensim.models \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" word2vec\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"print\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"\\\"Training model...\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"model \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" word2vec.Word2Vec(sentences,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"                        workers\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"num_workers,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"                        size\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"num_features,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"                        min_count\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"min_word_count,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"                        window\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"context,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"                        sample\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"downsampling)\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"2019-07-12 21:56:43,872 : INFO : collecting all words and their counts\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:43,872 : INFO : PROGRESS: at sentence #0, processed 0 words, keeping 0 word types\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Training model...\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"2019-07-12 21:56:44,092 : INFO : PROGRESS: at sentence #10000, processed 1205223 words, keeping 51374 word types\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:44,305 : INFO : PROGRESS: at sentence #20000, processed 2396605 words, keeping 67660 word types\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:44,406 : INFO : collected 74065 word types from a corpus of 2988089 raw words and 25000 sentences\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:44,406 : INFO : Loading a fresh vocabulary\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:44,443 : INFO : min_count=40 retains 8160 unique words (11% of original 74065, drops 65905)\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:44,443 : INFO : min_count=40 leaves 2627273 word corpus (87% of original 2988089, drops 360816)\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:44,454 : INFO : deleting the raw counts dictionary of 74065 items\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:44,469 : INFO : sample=0.001 downsamples 30 most-common words\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:44,469 : INFO : downsampling leaves estimated 2494384 word corpus (94.9% of prior 2627273)\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:44,481 : INFO : estimated required memory for 8160 words and 300 dimensions: 23664000 bytes\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:44,481 : INFO : resetting layer weights\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:44,577 : INFO : training model with 4 workers on 8160 vocabulary and 300 features, using sg=0 hs=0 sample=0.001 negative=5 window=10\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:45,578 : INFO : EPOCH 1 - PROGRESS: at 53.88% examples, 1354613 words/s, in_qsize 7, out_qsize 0\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:46,589 : INFO : EPOCH 1 - PROGRESS: at 97.12% examples, 1208841 words/s, in_qsize 8, out_qsize 0\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:46,625 : INFO : worker thread finished; awaiting finish of 3 more threads\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:46,631 : INFO : worker thread finished; awaiting finish of 2 more threads\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:46,639 : INFO : worker thread finished; awaiting finish of 1 more threads\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:46,645 : INFO : worker thread finished; awaiting finish of 0 more threads\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:46,649 : INFO : EPOCH - 1 : training on 2988089 raw words (2494785 effective words) took 2.1s, 1208654 effective words/s\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:47,643 : INFO : EPOCH 2 - PROGRESS: at 51.68% examples, 1296637 words/s, in_qsize 7, out_qsize 0\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:48,565 : INFO : worker thread finished; awaiting finish of 3 more threads\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:48,565 : INFO : worker thread finished; awaiting finish of 2 more threads\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:48,579 : INFO : worker thread finished; awaiting finish of 1 more threads\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:48,587 : INFO : worker thread finished; awaiting finish of 0 more threads\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:48,587 : INFO : EPOCH - 2 : training on 2988089 raw words (2494872 effective words) took 1.9s, 1287927 effective words/s\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:49,584 : INFO : EPOCH 3 - PROGRESS: at 52.03% examples, 1307272 words/s, in_qsize 7, out_qsize 0\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:50,495 : INFO : worker thread finished; awaiting finish of 3 more threads\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:50,504 : INFO : worker thread finished; awaiting finish of 2 more threads\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:50,504 : INFO : worker thread finished; awaiting finish of 1 more threads\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:50,513 : INFO : worker thread finished; awaiting finish of 0 more threads\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:50,513 : INFO : EPOCH - 3 : training on 2988089 raw words (2494507 effective words) took 1.9s, 1297134 effective words/s\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:51,508 : INFO : EPOCH 4 - PROGRESS: at 52.60% examples, 1319590 words/s, in_qsize 7, out_qsize 0\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:52,421 : INFO : worker thread finished; awaiting finish of 3 more threads\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:52,438 : INFO : worker thread finished; awaiting finish of 2 more threads\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:52,438 : INFO : worker thread finished; awaiting finish of 1 more threads\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:52,444 : INFO : worker thread finished; awaiting finish of 0 more threads\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:52,444 : INFO : EPOCH - 4 : training on 2988089 raw words (2494292 effective words) took 1.9s, 1293999 effective words/s\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:53,445 : INFO : EPOCH 5 - PROGRESS: at 54.20% examples, 1360524 words/s, in_qsize 7, out_qsize 0\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:54,212 : INFO : worker thread finished; awaiting finish of 3 more threads\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:54,228 : INFO : worker thread finished; awaiting finish of 2 more threads\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:54,235 : INFO : worker thread finished; awaiting finish of 1 more threads\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:54,241 : INFO : worker thread finished; awaiting finish of 0 more threads\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:54,242 : INFO : EPOCH - 5 : training on 2988089 raw words (2494012 effective words) took 1.8s, 1390220 effective words/s\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 21:56:54,242 : INFO : training on a 14940445 raw words (12472468 effective words) took 9.7s, 1291189 effective words/s\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"word2vec으로 학습시킨 모델의 경우 모델을 따로 저장해두면 이후 다시 사용할수 있기 때문에 저장해두자\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#768390\",\"--shiki-light\":\"#6A737D\"},\"children\":\"# 모델의 하이퍼파라미터를 설정한 내용을 모델 이름에 담는다면 나중에 참고하기 용이하다.\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#768390\",\"--shiki-light\":\"#6A737D\"},\"children\":\"# 모델을 저장하면 Word2Vec.load()를 통해 다시 사용할 수 있다.\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"model_name \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\" \\\"300features_40minwords_10context\\\"\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"model.save(model_name)\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"2019-07-12 22:00:40,807 : INFO : saving Word2Vec object under 300features_40minwords_10context, separately None\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 22:00:40,807 : INFO : not storing attribute vectors_norm\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 22:00:40,807 : INFO : not storing attribute cum_table\",[\"$\",\"br\",null,{}],\"\\n\",\"C:\\\\Users\\\\nicey.conda\\\\envs\\\\nlp\\\\lib\\\\site-packages\\\\smart_open\\\\smart_open_lib.py:398: UserWarning: This function is deprecated, use smart_open.open instead. See the migration notes for details: \",[\"$\",\"a\",null,{\"target\":\"_blank\",\"href\":\"https://github.com/RaRe-Technologies/smart_open/blob/master/README.rst#migrating-to-the-new-open-function\",\"className\":\"break-words text-pink-600 no-underline underline-offset-4 hover:underline\",\"children\":\"https://github.com/RaRe-Technologies/smart_open/blob/master/README.rst#migrating-to-the-new-open-function\"}],[\"$\",\"br\",null,{}],\"\\n\",\"'See the migration notes for details: %s' % _MIGRATION_NOTES_URL\",[\"$\",\"br\",null,{}],\"\\n\",\"2019-07-12 22:00:41,229 : INFO : saved 300features_40minwords_10context\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"에제 만들어진 word2vec 모델을 활용해 선형 회귀 모델을 학습해보자. 우선 학습을 위해 하나의 리뷰를 같은 형태의 입력값으로 만들어야 한다. 지금은 word2vec 모델에서 각 단어가 벡터로 표현돼 있다. 그리고 리뷰마다 단어의 개수가 모두 다르기 때문에 입력값을 하나으 형태로 만들어야 한다. 가장 단순한 방법은 문장에 있는 모든 단어의 벡터값에 대해 평균을 내서 리뷰 하나당 하나의 벡터로 만드는 방법이 있다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"그럼 하나의 리뷰에 대해 전체 단어의 평균값을 계산하는 함수를 구현하자\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" numpy \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" np\"}]]}]}]}]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"def\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#DCBDFB\",\"--shiki-light\":\"#6F42C1\"},\"children\":\" get_features\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(words, model, num_features):\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#768390\",\"--shiki-light\":\"#6A737D\"},\"children\":\"    # 출력 벡터 초기화\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"    feature_vector \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" np.zeros((num_features), \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"dtype\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"np.float32)\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"    \"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"    num_words \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" 0\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#768390\",\"--shiki-light\":\"#6A737D\"},\"children\":\"    # 어휘 사전 준비\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"    index2word_set \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" set\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(model.wv.index2word)\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"    \"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"    for\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" w \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" words:\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"        if\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" w \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" index2word_set:\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"            num_words \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" 1\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#768390\",\"--shiki-light\":\"#6A737D\"},\"children\":\"            # 사전에 해당하는 단어에 대해 단어 벡터를 더함\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"            feature_vector \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" np.add(feature_vector, model[w])\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"            \"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#768390\",\"--shiki-light\":\"#6A737D\"},\"children\":\"    # 문장의 단어 수만큼 나누어 단어 벡터의 평균값을 문장 벡터로 함\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"    feature_vector \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" np.divide(feature_vector, num_words)\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" feature_vector\"}]]}]]}]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"words : 단어의 모음인 하나의 리뷰가 들어간다.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"model : word2vec 모델을 넣는 공이며, 우리가 학습한 word2vec 모델이 들어간다.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"num_features : word2vec으로 임베딩할 때 정했던 벡터의 차원 수를 뜻한다.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"하나의 벡터를 만드는 과정을 빠르게 하기 위해 np.zeros를 사용해 미리 모두 0값을 가지는 벡터를 만든다. 그리고 문장의 단어가 모델 단어사전에 속하는지 보기 위해 model.wv.index2word를 set객체로 생성해서 index2word_set 변수에 할당한다. 다음 반복문을 통해 리뷰를 구성하는 단어에 대해 임베딩된 벡터가 있는 단어 벡터의 합을 구하고 사용한 단어의 전체 개수로 나누어 평균 벡터의 값을 구한다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"문장에 특징값을 만들 수 있는 함수를 구현했다면 이제 앞에서 정의한 함수를 사용해 전체 리뷰에 대해 각 리뷰의 평균 벡터를 구하는 함수를 정의하자\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"def\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#DCBDFB\",\"--shiki-light\":\"#6F42C1\"},\"children\":\" get_dataset\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(reviews, model, num_features):\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"    dataset \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" list\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"    \"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"    for\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" s \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" reviews:\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"        dataset.append(get_features(s, model, num_features))\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"        \"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"    reviewFeatureVecs \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" np.stack(dataset)\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" reviewFeatureVecs\"}]]}]]}]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"reviews : 학습 데이터인 전체 리뷰 데이터를 입력\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"model : word2vec 모델을 입력\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"num_features : word2vec으로 임베딩할 때 정했던 벡터의 차원 수\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"전체 리뷰에 대한 평균 벡터를 담을 0으로 채워진 numpy 배열을 미리 만든다. 배열은 2차원, 배열의 행에는 각 문장에 대한 길이, 열에는 평균 벡터의 차원수 즉 크기를 입력. 그리고 각 리뷰에 대해 반복문을 돌면서 각 리뷰에 대해 특징 값을 만든다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"구현한 함수를 사용해 실제 학습에 사용될 입력값을 만들어 보자.\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"test_data_vecs \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" get_dataset(sentences, model, num_features)\"}]]}]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"C:\\\\Users\\\\nicey.conda\\\\envs\\\\nlp\\\\lib\\\\site-packages\\\\ipykernel_launcher.py:13: DeprecationWarning: Call to deprecated \",[\"$\",\"code\",null,{\"children\":\"__getitem__\"}],\" (Method will be removed in 4.0.0, use self.wv.\",[\"$\",\"strong\",null,{\"children\":\"getitem\"}],\"() instead).\",[\"$\",\"br\",null,{}],\"\\n\",\"del sys.path[0]\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"학습과-검증-데이터셋-분리\",\"children\":\"학습과 검증 데이터셋 분리\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" sklearn.model_selection \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" train_test_split\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" numpy \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" np\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"X \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" test_data_vecs\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"y \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" np.array(sentiments)\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"RANDOM_SEED\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" 42\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"TEST_SPLIT\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" 0.2\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"X_train, X_test, y_train, y_test \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" train_test_split(X, y, \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"test_size\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"TEST_SPLIT\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\", \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"                                                    random_state\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"RANDOM_SEED\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"모델-선언-및-학습\",\"children\":\"모델 선언 및 학습\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" sklearn.linear_model \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" LogisticRegression\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"lgs \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" LogisticRegression(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"class_weight\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'balanced'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"lgs.fit(X_train, y_train)\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"C:\\\\Users\\\\nicey.conda\\\\envs\\\\nlp\\\\lib\\\\site-packages\\\\sklearn\\\\linear_model\\\\logistic.py:432: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning.\",[\"$\",\"br\",null,{}],\"\\n\",\"FutureWarning)\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"LogisticRegression(C=1.0, class_weight='balanced', dual=False,\",[\"$\",\"br\",null,{}],\"\\n\",\"fit_intercept=True, intercept_scaling=1, l1_ratio=None,\",[\"$\",\"br\",null,{}],\"\\n\",\"max_iter=100, multi_class='warn', n_jobs=None, penalty='l2',\",[\"$\",\"br\",null,{}],\"\\n\",\"random_state=None, solver='warn', tol=0.0001, verbose=0,\",[\"$\",\"br\",null,{}],\"\\n\",\"warm_start=False)\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"class_weight을 \",[\"$\",\"code\",null,{\"children\":\"balanced\"}],\"로 설정했다. 이는 각 라벨에 대해 균형있게 학습하기 위함이다.\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"검증-데이터셋을-이용한-성능-평가\",\"children\":\"검증 데이터셋을 이용한 성능 평가\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"predicted \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" lgs.predict(X_test)\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" sklearn \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" metrics\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"fpr, tpr, _ \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" metrics.roc_curve(y_test, (lgs.predict_proba(X_test)[:, \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"]))\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"auc \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" metrics.auc(fpr, tpr)\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"print\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"\\\"------------\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"print\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"\\\"Accuracy: \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#005CC5\"},\"children\":\"%f\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\" %\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" lgs.score(X_test, y_test))  \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#768390\",\"--shiki-light\":\"#6A737D\"},\"children\":\"#checking the accuracy\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"print\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"\\\"Precision: \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#005CC5\"},\"children\":\"%f\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\" %\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" metrics.precision_score(y_test, predicted))\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"print\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"\\\"Recall: \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#005CC5\"},\"children\":\"%f\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\" %\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" metrics.recall_score(y_test, predicted))\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"print\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"\\\"F1-Score: \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#005CC5\"},\"children\":\"%f\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\" %\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" metrics.f1_score(y_test, predicted))\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"print\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"\\\"AUC: \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#005CC5\"},\"children\":\"%f\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\" %\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" auc)\"}]]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Accuracy: 0.874200\",[\"$\",\"br\",null,{}],\"\\n\",\"Precision: 0.869141\",[\"$\",\"br\",null,{}],\"\\n\",\"Recall: 0.883287\",[\"$\",\"br\",null,{}],\"\\n\",\"F1-Score: 0.876157\",[\"$\",\"br\",null,{}],\"\\n\",\"AUC: 0.940927\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"학습 결과를 확인해 보면 TF-IDF를 사용해서 학습한 것보다 상대적으로 성능이 조금 떨어지는 것을 볼 수 있다. word2vec이 단어 간의 유사도를 보는 관점에서는 분명히 효과적일 수는 있지만 항상 좋은 성능을 보장하지는 않는다는 점을 알 수 있다.\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"데이터-제출\",\"children\":\"데이터 제출\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"TEST_CLEAN_DATA\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\" 'test_clean.csv'\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"test_data \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" pd.read_csv(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"DATA_IN_PATH\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\" +\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" TEST_CLEAN_DATA\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"test_review \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" list\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(test_data[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'review'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"])\"}]]}]]}]}]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"test_data.head(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"5\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}]}]}]}],\"\\n\",[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{}],[\"$\",\"th\",null,{\"children\":\"review\"}],[\"$\",\"th\",null,{\"children\":\"id\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"0\"}],[\"$\",\"td\",null,{\"children\":\"naturally film main themes mortality nostalgia...\"}],[\"$\",\"td\",null,{\"children\":\"\\\"12311_10\\\"\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"1\"}],[\"$\",\"td\",null,{\"children\":\"movie disaster within disaster film full great...\"}],[\"$\",\"td\",null,{\"children\":\"\\\"8348_2\\\"\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"2\"}],[\"$\",\"td\",null,{\"children\":\"movie kids saw tonight child loved one point k...\"}],[\"$\",\"td\",null,{\"children\":\"\\\"5828_4\\\"\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"3\"}],[\"$\",\"td\",null,{\"children\":\"afraid dark left impression several different ...\"}],[\"$\",\"td\",null,{\"children\":\"\\\"7186_2\\\"\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"4\"}],[\"$\",\"td\",null,{\"children\":\"accurate depiction small time mob life filmed ...\"}],[\"$\",\"td\",null,{\"children\":\"\\\"12128_7\\\"\"}]]}]]}]]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"test_sentences \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" list\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"for\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" review \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" test_review:\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"    test_sentences.append(review.split())\"}]}]]}]}]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"test_data_vecs \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" get_dataset(test_sentences, model, num_features)\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"test_predicted \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" lgs.predict(test_data_vecs)\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"C:\\\\Users\\\\nicey.conda\\\\envs\\\\nlp\\\\lib\\\\site-packages\\\\ipykernel_launcher.py:13: DeprecationWarning: Call to deprecated \",[\"$\",\"code\",null,{\"children\":\"__getitem__\"}],\" (Method will be removed in 4.0.0, use self.wv.\",[\"$\",\"strong\",null,{\"children\":\"getitem\"}],\"() instead).\",[\"$\",\"br\",null,{}],\"\\n\",\"del sys.path[0]\"]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" os\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"DATA_OUT_PATH\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\" './data_out/'\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\" not\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" os.path.exists(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"DATA_OUT_PATH\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"):\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"    os.makedirs(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"DATA_OUT_PATH\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"ids \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" list\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(test_data[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'id'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"])\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"answer_dataset \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" pd.DataFrame({\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'id'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\": ids, \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'sentiment'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\": test_predicted})\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"answer_dataset.to_csv(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"DATA_OUT_PATH\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\" +\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\" 'lgs_w2v_answer.csv'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"index\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"False\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"quoting\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"3\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}]]}]}]}]]\n"])</script><script>self.__next_f.push([1,""])</script></body></html>