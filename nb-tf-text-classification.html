<!DOCTYPE html><html lang="ko" class="h-full scroll-smooth"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/><link rel="preload" as="image" href="/posts/ai/nb-tf-text-classification/output_39_0.png"/><link rel="preload" as="image" href="/posts/ai/nb-tf-text-classification/output_40_0.png"/><link rel="stylesheet" href="/_next/static/css/81c2358a4e4f0309.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-b74314d4ae6a70b9.js" crossorigin=""/><script src="/_next/static/chunks/b40443eb-6913cff014374d9b.js" async="" crossorigin=""></script><script src="/_next/static/chunks/848-d93e525e2af78b30.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-a4a2ebec86a29373.js" async="" crossorigin=""></script><script src="/_next/static/chunks/605-9393b79bc12886be.js" async=""></script><script src="/_next/static/chunks/62-85f1524ddbccd7d3.js" async=""></script><script src="/_next/static/chunks/852-c2cfb369752384b4.js" async=""></script><script src="/_next/static/chunks/19-0903852a99880885.js" async=""></script><script src="/_next/static/chunks/504-3639e99a890852f8.js" async=""></script><script src="/_next/static/chunks/app/layout-fc709578bf0ffcd4.js" async=""></script><script src="/_next/static/chunks/app/(blog)/%5Bslug%5D/page-c22a71244d371731.js" async=""></script><link rel="preload" href="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1154659137489563" as="script"/><link rel="preload" href="https://www.googletagmanager.com/gtm.js?id=GTM-M5JW97ZQ" as="script"/><title>TF - 텍스트 분류 | DevTimes</title><meta name="description" content="TF - 텍스트 분류"/><meta property="og:title" content="TF - 텍스트 분류 | DevTimes"/><meta property="og:description" content="TF - 텍스트 분류"/><meta property="og:url" content="https://devtimes.com/nb-tf-text-classification"/><meta property="og:image" content="https://devtimes.com/posts/ai/nb-tf-text-classification/cover.png"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2019-08-07T00:00:00.000Z"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="TF - 텍스트 분류 | DevTimes"/><meta name="twitter:description" content="TF - 텍스트 분류"/><meta name="twitter:image" content="https://devtimes.com/posts/ai/nb-tf-text-classification/cover.png"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="518x518"/><link rel="icon" href="/icon.png?8d4a794a4e2a4e0b" type="image/png" sizes="518x518"/><link rel="apple-touch-icon" href="/apple-icon.png?8d4a794a4e2a4e0b" type="image/png" sizes="518x518"/><script>(self.__next_s=self.__next_s||[]).push(["https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1154659137489563",{"crossOrigin":"anonymous","id":"adsbygoogle-init"}])</script><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body class="flex min-h-screen flex-col font-pretendard"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><nav style="margin-top:0" class="fixed z-40 flex w-full flex-col items-center justify-center border-b bg-background shadow-sm print:hidden"><div class="mt-1 flex h-[64px] w-full max-w-[1200px] items-center justify-between px-4"><div class="flex items-center font-medium"><a class="rounded-full px-4 py-1 text-center text-sm transition-colors hover:text-primary bg-muted font-medium text-primary" href="/">DEVTIMES</a><a class="rounded-full px-4 py-1 text-center text-sm transition-colors hover:text-primary text-muted-foreground" href="/about">About</a></div><div class="flex gap-3"><a target="_blank" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground aspect-square p-2" href="https://github.com/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-github size-[1.2rem]"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg></a></div></div></nav><main class="mt-[calc(64px+env(safe-area-inset-top))] flex flex-1 flex-col"><div class="prose mx-auto w-full max-w-[750px] px-5 dark:prose-invert sm:px-6"><header class="mt-14 text-center"><h1 class="mb-5 text-3xl">TF - 텍스트 분류</h1><div class="mb-3 text-base"><a class="font-semibold text-pink-600 no-underline underline-offset-4 hover:underline" href="/ai">Ai</a></div><div class="flex justify-center gap-3 text-sm text-gray-500 dark:text-gray-400"><div class="flex items-center gap-1"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calendar-days w-3.5"><path d="M8 2v4"></path><path d="M16 2v4"></path><rect width="18" height="18" x="3" y="4" rx="2"></rect><path d="M3 10h18"></path><path d="M8 14h.01"></path><path d="M12 14h.01"></path><path d="M16 14h.01"></path><path d="M8 18h.01"></path><path d="M12 18h.01"></path><path d="M16 18h.01"></path></svg><span>2019년 08월 07일</span></div><div class="flex items-center gap-1"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clock3 w-3.5"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16.5 12"></polyline></svg><span>20<!-- -->분</span></div></div><hr class="mt-5"/></header><nav class="xl:hidden"><h2 id="table-of-contents-top">On this page</h2><ul><li class="my-0 py-1"><a class="underline-offset-4 hover:text-pink-600" href="#text-classification"> Text Classification</a></li><li class="ml-4 my-0 py-1"><a class="underline-offset-4 hover:text-pink-600" href="#데이터-준비"> 데이터 준비</a></li><li class="my-0 py-1"><a class="underline-offset-4 hover:text-pink-600" href="#decode-example"> decode example</a></li><li class="my-0 py-1"><a class="underline-offset-4 hover:text-pink-600" href="#데이터-전치리"> 데이터 전치리</a></li><li class="my-0 py-1"><a class="underline-offset-4 hover:text-pink-600" href="#모델-구성하기"> 모델 구성하기</a></li><li class="my-0 py-1"><a class="underline-offset-4 hover:text-pink-600" href="#모델-훈련하기"> 모델 훈련하기</a></li><li class="my-0 py-1"><a class="underline-offset-4 hover:text-pink-600" href="#정확도와-손실-그래프-그리기"> 정확도와 손실 그래프 그리기</a></li></ul><hr/></nav><article class="relative"><aside class="not-prose absolute -top-[200px] left-full -mb-[100px] hidden h-[calc(100%+150px)] xl:block "><div class="sticky bottom-0  top-[200px] z-10 ml-[5rem] mt-[200px] w-[200px]"><div class="mb-4 border-l px-4 py-2"><div class="mb-1 font-bold">On this page</div><ul class="text-xs"><li class="py-1 transition"><a href="#text-classification"> Text Classification</a></li><li class="ml-4 py-1 transition"><a href="#데이터-준비"> 데이터 준비</a></li><li class="py-1 transition"><a href="#decode-example"> decode example</a></li><li class="py-1 transition"><a href="#데이터-전치리"> 데이터 전치리</a></li><li class="py-1 transition"><a href="#모델-구성하기"> 모델 구성하기</a></li><li class="py-1 transition"><a href="#모델-훈련하기"> 모델 훈련하기</a></li><li class="py-1 transition"><a href="#정확도와-손실-그래프-그리기"> 정확도와 손실 그래프 그리기</a></li></ul></div><div class="flex gap-2"><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 outline outline-input outline-1 bg-background hover:bg-accent hover:text-accent-foreground aspect-square p-2"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-up-to-line "><path d="M5 3h14"></path><path d="m18 13-6-6-6 6"></path><path d="M12 7v14"></path></svg></button><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 outline outline-input outline-1 bg-background hover:bg-accent hover:text-accent-foreground aspect-square p-2"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-message-square-text "><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path><path d="M13 8H7"></path><path d="M17 12H7"></path></svg></button><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 outline outline-input outline-1 bg-background hover:bg-accent hover:text-accent-foreground aspect-square p-2"><span class="sr-only">Copy</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></div></div></aside><p>지난번에 TF-IDF 및 Word2Vec을 이용해 텍스트를 분류해 보았다. 이번에는 텐서플로를 이용하여 텍스트를 분류 해보자.</p>
<p>여기에서는 인터넷 영화 데이터베이스(Internet Movie Database)에서 수집한 50,000개의 영화 리뷰 텍스트를 담은 IMDB 데이터셋을 사용하겠다. 25,000개 리뷰는 훈련용으로, 25,000개는 테스트용으로 나뉘어져 있고, 훈련 세트와 테스트 세트의 클래스는 균형이 잡혀 있다. 즉 긍정적인 리뷰와 부정적인 리뷰의 개수가 동일하다.</p>
<p>데이터는 Keras에서 제공하는 datasets를 이용하여 다운로드 하자.</p>
<h2 id="text-classification">Text Classification</h2>
<p><a target="_blank" href="https://www.tensorflow.org/tutorials/keras/basic_text_classification?hl=ko" class="break-words text-pink-600 no-underline underline-offset-4 hover:underline">https://www.tensorflow.org/tutorials/keras/basic_text_classification?hl=ko</a></p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">from</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> __future__</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49"> import</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> absolute_import, division, print_function, unicode_literals, unicode_literals</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">import</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> tensorflow </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">as</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> tf</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">from</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> tensorflow </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">import</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> keras</span></span></code></pre></figure>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">import</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> numpy </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">as</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> np</span></span>
<span data-line=""><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">print</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(tf.</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">__version__</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span>
<span data-line=""><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">print</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(np.</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">__version__</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span></code></pre></figure>
<p>1.13.1<br/>
<!-- -->1.16.2</p>
<p>만약 numpy 버전이 1.16.2 이상의 버전이라면 삭제 후 버전을 지정하여 설치를 해야 한다.</p>
<p>(imdb.load_data를 하는 도중 오류 발생)</p>
<div class="my-6 flex items-center gap-3 rounded-md px-5 py-4 text-secondary-foreground bg-secondary"><div class="callout-contents flex-1">
<p>conda install numpy=1.16.2</p>
</div></div>
<h3 id="데이터-준비">데이터 준비</h3>
<ul>
<li>keras dataset에 있는 imdb를 사용한다.</li>
<li>train과 test 데이터 셋은 각각 25,000개 이며 데이터는 review 자체로 구성</li>
<li>labels는 0또는 1값으로 긍정 부정을 나타냄</li>
</ul>
<div class="my-6 flex items-center gap-3 rounded-md px-5 py-4 text-secondary-foreground bg-secondary"><div class="callout-contents flex-1">
<p>test데이터를 이용하여 해당 Review가 영화에 대해 긍정 또는 부정적인지를 예측해 본다.</p>
</div></div>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">imdb </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> keras.datasets.imdb</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(train_data, train_labels), (test_data, test_labels) </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> imdb.load_data(</span><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">num_words</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">10000</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span></code></pre></figure>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">print</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&quot;훈련 샘플: </span><span style="--shiki-dark:#F47067;--shiki-light:#005CC5">{}</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">, 레이블: </span><span style="--shiki-dark:#F47067;--shiki-light:#005CC5">{}</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&quot;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">.format(</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">len</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(train_data), </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">len</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(train_labels)))</span></span></code></pre></figure>
<p>훈련 샘플: 25000, 레이블: 25000</p>
<p>실제 데이터를 살펴보면 문자가 아닌 숫자 값이 리스트로 들어있다.</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">print</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(train_data[</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">0</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">])</span></span></code></pre></figure>
<p>[1, 14, 22, 16, 43, 530, 973, 1622, 1385, 65, 458, 4468, 66, 3941, 4, 173, 36, 256, 5, 25, 100, 43, 838, 112, 50, 670, 2, 9, 35, 480, 284, 5, 150, 4, 172, 112, 167, 2, 336, 385, 39, 4, 172, 4536, 1111, 17, 546, 38, 13, 447, 4, 192, 50, 16, 6, 147, 2025, 19, 14, 22, 4, 1920, 4613, 469, 4, 22, 71, 87, 12, 16, 43, 530, 38, 76, 15, 13, 1247, 4, 22, 17, 515, 17, 12, 16, 626, 18, 2, 5, 62, 386, 12, 8, 316, 8, 106, 5, 4, 2223, 5244, 16, 480, 66, 3785, 33, 4, 130, 12, 16, 38, 619, 5, 25, 124, 51, 36, 135, 48, 25, 1415, 33, 6, 22, 12, 215, 28, 77, 52, 5, 14, 407, 16, 82, 2, 8, 4, 107, 117, 5952, 15, 256, 4, 2, 7, 3766, 5, 723, 36, 71, 43, 530, 476, 26, 400, 317, 46, 7, 4, 2, 1029, 13, 104, 88, 4, 381, 15, 297, 98, 32, 2071, 56, 26, 141, 6, 194, 7486, 18, 4, 226, 22, 21, 134, 476, 26, 480, 5, 144, 30, 5535, 18, 51, 36, 28, 224, 92, 25, 104, 4, 226, 65, 16, 38, 1334, 88, 12, 16, 283, 5, 16, 4472, 113, 103, 32, 15, 16, 5345, 19, 178, 32]</p>
<p>이렇게 되어 있는 이유는 추가적인 dictionary에 각 숫자와 단어가 매칭되어 있기 때문이다. 또한 아래와 같이 각각의 데이터 길이도 다른것을 확인 할 수 있다.</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">len</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(train_data[</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">0</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">]), </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">len</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(train_data[</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">1</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">])</span></span></code></pre></figure>
<p>(218, 189)</p>
<p>하지만 실제로 ML모델에 넣어줄때는 입력 길이는 모두 같아야 한다. 따라서 입력길이를 모두 동일하게 해주는 작업이 필요하다. 먼저 데이터를 보다 자세히 확인해보기 위해 각 데이터의 숫자를 단어로 치환해 보자.</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D"># 숫자로 된 값을 단어로 바꾸기 위한 dictionary를 가져온다.</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">word_index </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> imdb.get_word_index()</span></span></code></pre></figure>
<ul>
<li>word_index</li>
</ul>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="json" data-theme="github-dark-dimmed github-light"><code data-language="json" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">{</span></span>
<span data-line=""><span style="--shiki-dark:#FF938A;--shiki-light:#B31D28;--shiki-dark-font-style:italic;--shiki-light-font-style:italic"> &#x27;fawn&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">: </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">34701</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">,</span></span>
<span data-line=""><span style="--shiki-dark:#FF938A;--shiki-light:#B31D28;--shiki-dark-font-style:italic;--shiki-light-font-style:italic"> &#x27;tsukino&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">: </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">52006</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">,</span></span>
<span data-line=""><span style="--shiki-dark:#FF938A;--shiki-light:#B31D28;--shiki-dark-font-style:italic;--shiki-light-font-style:italic"> &#x27;nunnery&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">: </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">52007</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">,</span></span>
<span data-line=""><span style="--shiki-dark:#FF938A;--shiki-light:#B31D28;--shiki-dark-font-style:italic;--shiki-light-font-style:italic"> &#x27;sonja&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">: </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">16816</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">,</span></span>
<span data-line=""><span style="--shiki-dark:#FF938A;--shiki-light:#B31D28;--shiki-dark-font-style:italic;--shiki-light-font-style:italic"> &#x27;vani&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">: </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">63951</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">,</span></span>
<span data-line=""><span style="--shiki-dark:#FF938A;--shiki-light:#B31D28;--shiki-dark-font-style:italic;--shiki-light-font-style:italic"> &#x27;woods&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">: </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">1408</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">,</span></span>
<span data-line=""><span style="--shiki-dark:#FF938A;--shiki-light:#B31D28;--shiki-dark-font-style:italic;--shiki-light-font-style:italic"> ...</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">}</span></span></code></pre></figure>
<ul>
<li>word_index.items()</li>
</ul>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="shell" data-theme="github-dark-dimmed github-light"><code data-language="shell" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">&gt;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> dict_items([(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;fawn&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">34701</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">), (</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;tsukino&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">52006</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">), </span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;nunnery&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">52007</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">), (</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;sonja&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">16816</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">), </span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;vani&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">63951</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">), (</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;woods&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">1408</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">), </span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;spiders&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">16115</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">) ,,,</span></span></code></pre></figure>
<p>pad, start, unknown, unused 값을 나타내기 위해 각 value에 3을 더하고 비어있게 되는 0~3에 각각을 할당한다.</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D"># 처음 몇 개 인덱스는 사전에 정의되어 있습니다</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">word_index </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> {k:(v</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">+</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">3</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">) </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">for</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> k,v </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">in</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> word_index.items()} </span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">word_index[</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&quot;&lt;PAD&gt;&quot;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">] </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 0</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">word_index[</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&quot;&lt;START&gt;&quot;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">] </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 1</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">word_index[</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&quot;&lt;UNK&gt;&quot;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">] </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 2</span><span style="--shiki-dark:#768390;--shiki-light:#6A737D">  # unknown</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">word_index[</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&quot;&lt;UNUSED&gt;&quot;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">] </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 3</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">reverse_word_index </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> dict</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">([(value, key) </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">for</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> (key, value) </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">in</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> word_index.items()])</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">def</span><span style="--shiki-dark:#DCBDFB;--shiki-light:#6F42C1"> decode_review</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(text):</span></span>
<span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">    return</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> &#x27; &#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">.join([reverse_word_index.get(i, </span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;&lt;&#x27;</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">+</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">str</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(i)</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">+</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;&gt;?&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">) </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">for</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> i </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">in</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> text])</span></span></code></pre></figure>
<p>실제로 필요한 dictionary는 숫자가 key이고, 단어가 value인 dictionary이기 때문에 reverse_word_index라는 dictionary를 구성하고 숫자로 이루어진 입력데이터를 단어로 치환해 주며 문장으로 출력하는 <strong>decode_review</strong> 함수를 만든다.</p>
<h2 id="decode-example">decode example</h2>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="shell" data-theme="github-dark-dimmed github-light"><code data-language="shell" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#6F42C1">-</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> [1,14,22,16,43,530...] =</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">&gt;</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> &quot;&lt;START&gt; &lt;14&gt;? &lt;22&gt;? &lt;16&gt;? film flick...&quot;</span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#6F42C1">-</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 1</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> :</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> `</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">&lt;</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">START</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">&gt;</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">`</span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#6F42C1">-</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 14</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">,</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 22</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">,</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 16</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> :</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> unknown</span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#6F42C1">-</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 43</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> :</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> film</span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#6F42C1">-</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 530</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> :</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62"> flick</span></span></code></pre></figure>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">decode_review(train_data[</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">0</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">])</span></span></code></pre></figure>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="shell" data-theme="github-dark-dimmed github-light"><code data-language="shell" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#6F42C1">    &quot;&lt;START&gt; this film was just brilliant casting location scenery story direction everyone&#x27;s really suited the part they played and you could just imagine being there robert &lt;UNK&gt; is an amazing actor and now the same being director &lt;UNK&gt; father came from the same scottish island as myself so i loved the fact there was a real connection with this film the witty remarks throughout the film were great it was just brilliant so much that i bought the film as soon as it was released for &lt;UNK&gt; and would recommend it to everyone to watch and the fly fishing was amazing really cried at the end it was so sad and you know what they say if you cry at a film it must have been good and this definitely was also &lt;UNK&gt; to the two little boy&#x27;s that played the &lt;UNK&gt; of norman and paul they were just brilliant children are often left out of the &lt;UNK&gt; list i think because the stars that play them all grown up are such a big profile for the whole film but these children are amazing and should be praised for what they have done don&#x27;t you think the whole story was so lovely because it was true and was someone&#x27;s life after all that was shared with us all&quot;</span></span></code></pre></figure>
<p>앞서 추가해주었던 <code>START</code>, <code>UNK</code> 등이 추가되어 보여지는 것을 확인할 수 있다.</p>
<h2 id="데이터-전치리">데이터 전치리</h2>
<p>위에서 언급했던 각 데이터의 길이가 상이한 것을 처리한다. keras에서 제공하는 preprocessing 함수를 이용하여 모든 데이터를 최대길이로 늘려주면서 빈공간에는 위에서 dictionary에 추가적으로 넣어주었던 pad값을 이용한다.</p>
<p>신경망에 주입하기 전에 텐서로 변환되어야 하는데, 변환하는 방법에는 몇 가지가 있다.</p>
<ul>
<li>원-핫 인코딩(one-hot encoding) : 정수 배열을 0과 1로 이루어진 벡터로 변환한다. 예를 들어 배열 [3, 5]을 인덱스 3과 5만 1이고 나머지는 모두 0인 10,000차원 벡터로 변환할 수 있다. 그다음 실수 벡터 데이터를 다룰 수 있는 층-Dense 층-을 신경망의 첫 번째 층으로 사용한다. 이 방법은 num_words * num_reviews 크기의 행렬이 필요하기 때문에 메모리를 많이 사용하게 된다는 단점이 있다.</li>
<li>다른 방법으로는, 정수 배열의 길이가 모두 같도록 패딩(padding)을 추가해 max_length * num_reviews 크기의 정수 텐서를 만드는 방법이다. 이런 형태의 텐서를 다룰 수 있는 임베딩(embedding) 층을 신경망의 첫 번째 층으로 사용할 수 있다.</li>
</ul>
<p>여기서는 두 번째 방식을 사용해보자.</p>
<p>영화 리뷰의 길이가 같아야 하므로 <strong>pad_sequences</strong> 함수를 사용해 길이를 맞추자.</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">train_data </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> keras.preprocessing.sequence.pad_sequences(train_data,</span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">                                                        value</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">word_index[</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&quot;&lt;PAD&gt;&quot;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">],</span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">                                                        padding</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;post&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">,</span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">                                                        maxlen</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">256</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">test_data </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> keras.preprocessing.sequence.pad_sequences(test_data,</span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">                                                        value</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">word_index[</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&quot;&lt;PAD&gt;&quot;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">],</span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">                                                        padding</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;post&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">,</span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">                                                        maxlen</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">256</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span></code></pre></figure>
<p>이 작업을 통해 변경된 것을 확인해 보면,</p>
<ol>
<li>train_data, test_data 길이가 동일</li>
<li>배열내 모든 데이터가 256</li>
<li>데이터 형태는 맨 뒤에 0값, 즉 pad값이 포함되어 있음</li>
</ol>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">len</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(train_data[</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">0</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">]), </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">len</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(train_data[</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">1</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">])</span></span></code></pre></figure>
<p>(256, 256)</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">print</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(train_data[</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">0</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">])</span></span></code></pre></figure>
<p>[   1   14   22   16   43  530  973 1622 1385   65  458 4468   66 3941<br/>
<!-- -->4  173   36  256    5   25  100   43  838  112   50  670    2    9<br/>
<!-- -->35  480  284    5  150    4  172  112  167    2  336  385   39    4<br/>
<!-- -->172 4536 1111   17  546   38   13  447    4  192   50   16    6  147<br/>
<!-- -->2025   19   14   22    4 1920 4613  469    4   22   71   87   12   16<br/>
<!-- -->43  530   38   76   15   13 1247    4   22   17  515   17   12   16<br/>
<!-- -->626   18    2    5   62  386   12    8  316    8  106    5    4 2223<br/>
<!-- -->5244   16  480   66 3785   33    4  130   12   16   38  619    5   25<br/>
<!-- -->124   51   36  135   48   25 1415   33    6   22   12  215   28   77<br/>
<!-- -->52    5   14  407   16   82    2    8    4  107  117 5952   15  256<br/>
<!-- -->4    2    7 3766    5  723   36   71   43  530  476   26  400  317<br/>
<!-- -->46    7    4    2 1029   13  104   88    4  381   15  297   98   32<br/>
<!-- -->2071   56   26  141    6  194 7486   18    4  226   22   21  134  476<br/>
<!-- -->26  480    5  144   30 5535   18   51   36   28  224   92   25  104<br/>
<!-- -->4  226   65   16   38 1334   88   12   16  283    5   16 4472  113<br/>
<!-- -->103   32   15   16 5345   19  178   32    0    0    0    0    0    0<br/>
<!-- -->0    0    0    0    0    0    0    0    0    0    0    0    0    0<br/>
<!-- -->0    0    0    0    0    0    0    0    0    0    0    0    0    0<br/>
<!-- -->0    0    0    0]</p>
<h2 id="모델-구성하기">모델 구성하기</h2>
<p>이제 text classification을 수행할 ML모델을 만들어보자.</p>
<p>vocab_size는 영화리뷰에 사용되는 단어의 개수이다. 실제로 위에서 단어와 숫자를 매칭하는 dictionary의 사이즈 보다 크지만, 해당 데이터에서는 10000개의 단어 이내로 리뷰가 작성되었다.</p>
<p>각 레이어에 대한 설명은 다음과 같다.</p>
<ol>
<li><strong>embedding</strong> : 숫자로 인코딩 되어있는 각 단어를 사용하며 각 단어 인덱스에 대한 벡터를 찾는다. 이러한 데이터는 추후 모델이 핫습하는데 사용된다.</li>
<li><strong>GlobalAveragePooling1D</strong> : 각 예시에 대해 sequence 차원을 평균하여 고정된 길이의 벡터를 출력한다.</li>
<li><strong>Dense</strong> : 첫번째 Dense 레이어를 통해서 고정길이로 출력된 vector값을 통해 16개의 hidden unit을 가진 fully-connected layer를 통과시킨다. 이후 두번째 Dense 레이어는 단일 출력 노드를 가지고 시그모이드 활성화 함수를 사용함으로써 결과에 대해 0~1 사이의 값을 가지도록 한다.</li>
</ol>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D"># 입력 크기는 영화 리뷰 데이터셋에 적용된 어휘 사전의 크기입니다(10,000개의 단어)</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">vocab_size </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 10000</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">model </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> keras.Sequential()</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">model.add(keras.layers.Embedding(vocab_size, </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">16</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, </span><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">input_shape</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">None</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">,)))</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">model.add(keras.layers.GlobalAveragePooling1D())</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">model.add(keras.layers.Dense(</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">16</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, </span><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">activation</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">tf.nn.relu))</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">model.add(keras.layers.Dense(</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">1</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, </span><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">activation</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">tf.nn.sigmoid))</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">model.summary()</span></span></code></pre></figure>
<hr/>
<h1 id="layer-type-----------------output-shape--------------param-">Layer (type)                 Output Shape              Param #</h1>
<p>embedding_2 (Embedding)      (None, None, 16)          160000</p>
<hr/>
<p>global_average_pooling1d_2 ( (None, 16)                0</p>
<hr/>
<p>dense_4 (Dense)              (None, 16)                272</p>
<hr/>
<h1 id="dense_5-dense--------------none-1-----------------17">dense_5 (Dense)              (None, 1)                 17</h1>
<p>Total params: 160,289<br/>
<!-- -->Trainable params: 160,289<br/>
<!-- -->Non-trainable params: 0</p>
<hr/>
<p>모델 구성에 마지막으로 loss function과 optimizer를 설정한다.</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">model.compile(</span><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">optimizer</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">tf.train.AdamOptimizer(),</span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">              loss</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;binary_crossentropy&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">,</span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">              metrics</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">[</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;acc&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">])</span></span></code></pre></figure>
<h2 id="모델-훈련하기">모델 훈련하기</h2>
<p>모델을 훈련하기에 앞서 10000개의 데이터를 분리하여 validation set을 만들자.<br/>
<!-- -->모델이 새롭게 접하는 데이터에 대한 accuracy와 loss등을 확인하기 위함이다.</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D"># 검증 세트 만들기</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">x_val </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> train_data[:</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">10000</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">]</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">partial_x_train </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> train_data[</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">10000</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">:]</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">y_val </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> train_labels[:</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">10000</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">]</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">partial_y_train </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> train_labels[</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">10000</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">:]</span></span></code></pre></figure>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D"># 모델 훈련</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">history </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> model.fit(partial_x_train,</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">                    partial_y_train,</span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">                    epochs</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">40</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">,</span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">                    batch_size</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">512</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">,</span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">                    validation_data</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(x_val, y_val),</span></span>
<span data-line=""><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">                    verbose</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">1</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span></code></pre></figure>
<p>Train on 15000 samples, validate on 10000 samples<br/>
<!-- -->Epoch 1/40<br/>
<!-- -->15000/15000 [==============================] - 1s 99us/sample - loss: 0.6925 - acc: 0.5343 - val_loss: 0.6918 - val_acc: 0.5347<br/>
<!-- -->Epoch 2/40<br/>
<!-- -->15000/15000 [==============================] - 1s 69us/sample - loss: 0.6899 - acc: 0.6281 - val_loss: 0.6880 - val_acc: 0.6741<br/>
<!-- -->Epoch 3/40<br/>
<!-- -->15000/15000 [==============================] - 1s 70us/sample - loss: 0.6835 - acc: 0.7101 - val_loss: 0.6792 - val_acc: 0.7429<br/>
<!-- -->Epoch 4/40<br/>
<!-- -->15000/15000 [==============================] - 1s 70us/sample - loss: 0.6699 - acc: 0.7408 - val_loss: 0.6623 - val_acc: 0.7469<br/>
<!-- -->Epoch 5/40<br/>
<!-- -->15000/15000 [==============================] - 1s 71us/sample - loss: 0.6463 - acc: 0.7775 - val_loss: 0.6360 - val_acc: 0.7647<br/>
<!-- -->Epoch 6/40<br/>
<!-- -->15000/15000 [==============================] - 1s 71us/sample - loss: 0.6127 - acc: 0.7950 - val_loss: 0.6017 - val_acc: 0.7821<br/>
<!-- -->Epoch 7/40<br/>
<!-- -->15000/15000 [==============================] - 1s 71us/sample - loss: 0.5707 - acc: 0.8089 - val_loss: 0.5601 - val_acc: 0.7975<br/>
<!-- -->Epoch 8/40<br/>
<!-- -->15000/15000 [==============================] - 1s 70us/sample - loss: 0.5240 - acc: 0.8279 - val_loss: 0.5180 - val_acc: 0.8142<br/>
<!-- -->Epoch 9/40<br/>
<!-- -->15000/15000 [==============================] - 1s 72us/sample - loss: 0.4775 - acc: 0.8426 - val_loss: 0.4773 - val_acc: 0.8298<br/>
<!-- -->Epoch 10/40<br/>
<!-- -->15000/15000 [==============================] - 1s 72us/sample - loss: 0.4343 - acc: 0.8581 - val_loss: 0.4416 - val_acc: 0.8392<br/>
<!-- -->Epoch 11/40<br/>
<!-- -->15000/15000 [==============================] - 1s 72us/sample - loss: 0.3966 - acc: 0.8707 - val_loss: 0.4114 - val_acc: 0.8505<br/>
<!-- -->Epoch 12/40<br/>
<!-- -->15000/15000 [==============================] - 1s 72us/sample - loss: 0.3645 - acc: 0.8798 - val_loss: 0.3880 - val_acc: 0.8537<br/>
<!-- -->Epoch 13/40<br/>
<!-- -->15000/15000 [==============================] - 1s 71us/sample - loss: 0.3385 - acc: 0.8867 - val_loss: 0.3670 - val_acc: 0.8615<br/>
<!-- -->Epoch 14/40<br/>
<!-- -->15000/15000 [==============================] - 1s 71us/sample - loss: 0.3154 - acc: 0.8932 - val_loss: 0.3519 - val_acc: 0.8651<br/>
<!-- -->Epoch 15/40<br/>
<!-- -->15000/15000 [==============================] - 1s 71us/sample - loss: 0.2967 - acc: 0.8977 - val_loss: 0.3393 - val_acc: 0.8694<br/>
<!-- -->Epoch 16/40<br/>
<!-- -->15000/15000 [==============================] - 1s 71us/sample - loss: 0.2800 - acc: 0.9027 - val_loss: 0.3290 - val_acc: 0.8711<br/>
<!-- -->Epoch 17/40<br/>
<!-- -->15000/15000 [==============================] - 1s 72us/sample - loss: 0.2651 - acc: 0.9080 - val_loss: 0.3207 - val_acc: 0.8753<br/>
<!-- -->Epoch 18/40<br/>
<!-- -->15000/15000 [==============================] - 1s 72us/sample - loss: 0.2519 - acc: 0.9119 - val_loss: 0.3132 - val_acc: 0.8780<br/>
<!-- -->Epoch 19/40<br/>
<!-- -->15000/15000 [==============================] - 1s 72us/sample - loss: 0.2401 - acc: 0.9159 - val_loss: 0.3070 - val_acc: 0.8791<br/>
<!-- -->Epoch 20/40<br/>
<!-- -->15000/15000 [==============================] - 1s 71us/sample - loss: 0.2295 - acc: 0.9203 - val_loss: 0.3029 - val_acc: 0.8798<br/>
<!-- -->Epoch 21/40<br/>
<!-- -->15000/15000 [==============================] - 1s 72us/sample - loss: 0.2190 - acc: 0.9240 - val_loss: 0.2990 - val_acc: 0.8792<br/>
<!-- -->Epoch 22/40<br/>
<!-- -->15000/15000 [==============================] - 1s 72us/sample - loss: 0.2101 - acc: 0.9261 - val_loss: 0.2951 - val_acc: 0.8828<br/>
<!-- -->Epoch 23/40<br/>
<!-- -->15000/15000 [==============================] - 1s 72us/sample - loss: 0.2011 - acc: 0.9291 - val_loss: 0.2934 - val_acc: 0.8819<br/>
<!-- -->Epoch 24/40<br/>
<!-- -->15000/15000 [==============================] - 1s 72us/sample - loss: 0.1933 - acc: 0.9325 - val_loss: 0.2905 - val_acc: 0.8837<br/>
<!-- -->Epoch 25/40<br/>
<!-- -->15000/15000 [==============================] - 1s 71us/sample - loss: 0.1853 - acc: 0.9369 - val_loss: 0.2883 - val_acc: 0.8846<br/>
<!-- -->Epoch 26/40<br/>
<!-- -->15000/15000 [==============================] - 1s 71us/sample - loss: 0.1783 - acc: 0.9395 - val_loss: 0.2880 - val_acc: 0.8839<br/>
<!-- -->Epoch 27/40<br/>
<!-- -->15000/15000 [==============================] - 1s 71us/sample - loss: 0.1715 - acc: 0.9435 - val_loss: 0.2868 - val_acc: 0.8846<br/>
<!-- -->Epoch 28/40<br/>
<!-- -->15000/15000 [==============================] - 1s 71us/sample - loss: 0.1650 - acc: 0.9460 - val_loss: 0.2861 - val_acc: 0.8845<br/>
<!-- -->Epoch 29/40<br/>
<!-- -->15000/15000 [==============================] - 1s 71us/sample - loss: 0.1596 - acc: 0.9487 - val_loss: 0.2868 - val_acc: 0.8839<br/>
<!-- -->Epoch 30/40<br/>
<!-- -->15000/15000 [==============================] - 1s 71us/sample - loss: 0.1537 - acc: 0.9511 - val_loss: 0.2859 - val_acc: 0.8855<br/>
<!-- -->Epoch 31/40<br/>
<!-- -->15000/15000 [==============================] - 1s 71us/sample - loss: 0.1477 - acc: 0.9538 - val_loss: 0.2861 - val_acc: 0.8857<br/>
<!-- -->Epoch 32/40<br/>
<!-- -->15000/15000 [==============================] - 1s 70us/sample - loss: 0.1423 - acc: 0.9558 - val_loss: 0.2867 - val_acc: 0.8857<br/>
<!-- -->Epoch 33/40<br/>
<!-- -->15000/15000 [==============================] - 1s 70us/sample - loss: 0.1370 - acc: 0.9571 - val_loss: 0.2882 - val_acc: 0.8858<br/>
<!-- -->Epoch 34/40<br/>
<!-- -->15000/15000 [==============================] - 1s 70us/sample - loss: 0.1324 - acc: 0.9605 - val_loss: 0.2892 - val_acc: 0.8868<br/>
<!-- -->Epoch 35/40<br/>
<!-- -->15000/15000 [==============================] - 1s 70us/sample - loss: 0.1282 - acc: 0.9607 - val_loss: 0.2907 - val_acc: 0.8871<br/>
<!-- -->Epoch 36/40<br/>
<!-- -->15000/15000 [==============================] - 1s 70us/sample - loss: 0.1234 - acc: 0.9636 - val_loss: 0.2923 - val_acc: 0.8866<br/>
<!-- -->Epoch 37/40<br/>
<!-- -->15000/15000 [==============================] - 1s 70us/sample - loss: 0.1189 - acc: 0.9657 - val_loss: 0.2941 - val_acc: 0.8860<br/>
<!-- -->Epoch 38/40<br/>
<!-- -->15000/15000 [==============================] - 1s 70us/sample - loss: 0.1148 - acc: 0.9671 - val_loss: 0.2968 - val_acc: 0.8852<br/>
<!-- -->Epoch 39/40<br/>
<!-- -->15000/15000 [==============================] - 1s 70us/sample - loss: 0.1113 - acc: 0.9683 - val_loss: 0.2990 - val_acc: 0.8846<br/>
<!-- -->Epoch 40/40<br/>
<!-- -->15000/15000 [==============================] - 1s 71us/sample - loss: 0.1073 - acc: 0.9699 - val_loss: 0.3009 - val_acc: 0.8841</p>
<p>Epoch 1에서 40까지 진행이 되고 해당 Epoch에서의 acc 및 loss를 확인할 수 있다.</p>
<p>이제 모델 평가 결과를 확인해 보자.</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">results </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> model.evaluate(test_data, test_labels)</span></span>
<span data-line=""><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">print</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(results)</span></span></code></pre></figure>
<p>25000/25000 [==============================] - 1s 21us/sample - loss: 0.3204 - acc: 0.8736<br/>
<!-- -->[0.3203906687307358, 0.8736]</p>
<p>실제로 더 진보된 모델이라고 하기 위해서는 약 95% 이상의 정확도를 필요로 한다. 하지만 매우 단순한 방식을 사용했기 때문에 약 87% 정도의 정확도를 달성한 것을 확인 할 수 있다.</p>
<p>결과를 정확도와 오차의 그래프로 확인해 보자.</p>
<h2 id="정확도와-손실-그래프-그리기">정확도와 손실 그래프 그리기</h2>
<p><code>model.fit()</code>은 History 객체를 반환한다. 여기에는 훈련하는 동안 일어난 모든 정보가 dictionary로 담겨 있다.</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">history_dict </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> history.history</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">history_dict.keys()</span></span></code></pre></figure>
<p>dict_keys([&#x27;loss&#x27;, &#x27;acc&#x27;, &#x27;val_loss&#x27;, &#x27;val_acc&#x27;])</p>
<p>키를 확인해 보면 네개의 항목이 있다. 이는 훈련과 검증 단계에서 모니터링하는 지표들이다. 훈련 손실과 검증 손실을 그래프로 그려 보고, 훈련 정확도와 검증 정확도도 그래프로 그려 비교해 보자.</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">import</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> matplotlib.pyplot </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">as</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> plt</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">acc </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> history_dict[</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;acc&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">]</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">val_acc </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> history_dict[</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;val_acc&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">]</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">loss </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> history_dict[</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;loss&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">]</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">val_loss </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E"> history_dict[</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;val_loss&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">]</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">epochs </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> range</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">1</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, </span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5">len</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">(acc) </span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">+</span><span style="--shiki-dark:#6CB6FF;--shiki-light:#005CC5"> 1</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#768390;--shiki-light:#6A737D"># &#x27;bo&#x27;는 파란색점, &#x27;b&#x27;는 파란 실선</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">plt.plot(epochs, loss, </span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;bo&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, </span><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">label</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;Training loss&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">plt.plot(epochs, val_loss, </span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;b&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, </span><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">label</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;Validation loss&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">plt.title(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;Training and validation loss&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">plt.xlabel(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;Epochs&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">plt.ylabel(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;Loss&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">plt.legend()</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">plt.show()</span></span>
<span data-line=""> </span></code></pre></figure>
<p><img src="/posts/ai/nb-tf-text-classification/output_39_0.png" alt="png" class="mx-auto mb-0 mt-8 rounded-md"/><span class="mb-8 mt-2 block w-full text-center text-sm text-gray-500 dark:text-gray-400">png</span></p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#adbac7;--shiki-light:#24292e;--shiki-dark-bg:#22272e;--shiki-light-bg:#fff" tabindex="0" data-language="python" data-theme="github-dark-dimmed github-light"><code data-language="python" data-theme="github-dark-dimmed github-light" style="display:grid"><span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">plt.clf()   </span><span style="--shiki-dark:#768390;--shiki-light:#6A737D"># 그림을 초기화합니다</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">plt.plot(epochs, acc, </span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;bo&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, </span><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">label</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;Training acc&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">plt.plot(epochs, val_acc, </span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;b&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">, </span><span style="--shiki-dark:#F69D50;--shiki-light:#E36209">label</span><span style="--shiki-dark:#F47067;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;Validation acc&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">plt.title(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;Training and validation accuracy&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">plt.xlabel(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;Epochs&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">plt.ylabel(</span><span style="--shiki-dark:#96D0FF;--shiki-light:#032F62">&#x27;Accuracy&#x27;</span><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">)</span></span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">plt.legend()</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#ADBAC7;--shiki-light:#24292E">plt.show()</span></span></code></pre></figure>
<p><img src="/posts/ai/nb-tf-text-classification/output_40_0.png" alt="png" class="mx-auto mb-0 mt-8 rounded-md"/><span class="mb-8 mt-2 block w-full text-center text-sm text-gray-500 dark:text-gray-400">png</span></p>
<p>점선은 훈련 loss와 accuracy이고 실선은 검증 loss와 accuracy를 나타낸다.</p>
<p>훈련(점선)에서 loss는 epoch가 진행되면서 감소하고 accuracy는 증가한다. 하지만 검증(실선)에서는 약 20번째 epoch 이후가 최적점인 것 같다. 이는 훈련 데이터에서만 잘 동작하는 과대적합 때문일 것이다. 이 지점 부터는 모델이 과도하게 최적화되어 테스트 데이터에서 일반화되기 어려운 훈련 데이터 특정 표현을 학습하게 된다.</p>
<p>여기에서는 과대적합을 막기 위해 단순히 20번째 epoch 근처에서 훈련을 멈출 수 있다.</p></article><hr/><section></section><div class="group fixed bottom-4 right-4 xl:hidden"><div class="group relative flex flex-col-reverse"><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 outline outline-input outline-1 bg-background hover:bg-accent hover:text-accent-foreground aspect-square p-2 absolute bottom-0 right-0 z-10 transition"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bolt "><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><circle cx="12" cy="12" r="4"></circle></svg></button><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 outline outline-input outline-1 bg-background hover:bg-accent hover:text-accent-foreground aspect-square p-2 absolute bottom-0 right-0 transition"><span class="sr-only">Copy</span><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy "><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 outline outline-input outline-1 bg-background hover:bg-accent hover:text-accent-foreground aspect-square p-2 absolute bottom-0 right-0 transition"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-message-square-text "><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path><path d="M13 8H7"></path><path d="M17 12H7"></path></svg></button><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 outline outline-input outline-1 bg-background hover:bg-accent hover:text-accent-foreground aspect-square p-2 absolute bottom-0 right-0 transition"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-up-to-line "><path d="M5 3h14"></path><path d="m18 13-6-6-6 6"></path><path d="M12 7v14"></path></svg></button></div></div></div></main><footer class="mb-16 mt-20 flex flex-col items-center justify-center gap-4 text-center print:hidden"><div class="flex justify-center gap-4"><a target="_blank" href="https://github.com/"><svg fill="currentColor" viewBox="0 0 16 16" height="30" width="30" class="fill-foreground transition hover:fill-pink-600"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a><a target="_blank" href="https://www.linkedin.com/in/"><svg viewBox="0 0 24 24" fill="currentColor" height="30" width="30" class="fill-foreground transition hover:fill-pink-600"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a></div><div>© 2024. <span class="font-semibold">Devtimes</span> all rights reserved.</div></footer><div role="region" aria-label="Notifications (F8)" tabindex="-1" style="pointer-events:none"><ol tabindex="-1" class="fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[300px]"></ol></div><script src="/_next/static/chunks/webpack-b74314d4ae6a70b9.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/81c2358a4e4f0309.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:I[2386,[],\"\"]\n6:I[9261,[],\"\"]\n8:I[6675,[],\"\"]\n9:I[1441,[\"605\",\"static/chunks/605-9393b79bc12886be.js\",\"62\",\"static/chunks/62-85f1524ddbccd7d3.js\",\"852\",\"static/chunks/852-c2cfb369752384b4.js\",\"19\",\"static/chunks/19-0903852a99880885.js\",\"504\",\"static/chunks/504-3639e99a890852f8.js\",\"185\",\"static/chunks/app/layout-fc709578bf0ffcd4.js\"],\"\"]\na:I[8390,[\"605\",\"static/chunks/605-9393b79bc12886be.js\",\"62\",\"static/chunks/62-85f1524ddbccd7d3.js\",\"852\",\"static/chunks/852-c2cfb369752384b4.js\",\"19\",\"static/chunks/19-0"])</script><script>self.__next_f.push([1,"903852a99880885.js\",\"504\",\"static/chunks/504-3639e99a890852f8.js\",\"185\",\"static/chunks/app/layout-fc709578bf0ffcd4.js\"],\"ThemeProvider\"]\nb:I[7083,[\"605\",\"static/chunks/605-9393b79bc12886be.js\",\"62\",\"static/chunks/62-85f1524ddbccd7d3.js\",\"852\",\"static/chunks/852-c2cfb369752384b4.js\",\"19\",\"static/chunks/19-0903852a99880885.js\",\"504\",\"static/chunks/504-3639e99a890852f8.js\",\"185\",\"static/chunks/app/layout-fc709578bf0ffcd4.js\"],\"Header\"]\nc:I[9605,[\"605\",\"static/chunks/605-9393b79bc12886be.js\",\"62\",\"static/chunks"])</script><script>self.__next_f.push([1,"/62-85f1524ddbccd7d3.js\",\"206\",\"static/chunks/app/(blog)/%5Bslug%5D/page-c22a71244d371731.js\"],\"\"]\nd:I[3760,[\"605\",\"static/chunks/605-9393b79bc12886be.js\",\"62\",\"static/chunks/62-85f1524ddbccd7d3.js\",\"852\",\"static/chunks/852-c2cfb369752384b4.js\",\"19\",\"static/chunks/19-0903852a99880885.js\",\"504\",\"static/chunks/504-3639e99a890852f8.js\",\"185\",\"static/chunks/app/layout-fc709578bf0ffcd4.js\"],\"Toaster\"]\ne:I[8968,[\"605\",\"static/chunks/605-9393b79bc12886be.js\",\"62\",\"static/chunks/62-85f1524ddbccd7d3.js\",\"852\",\"stati"])</script><script>self.__next_f.push([1,"c/chunks/852-c2cfb369752384b4.js\",\"19\",\"static/chunks/19-0903852a99880885.js\",\"504\",\"static/chunks/504-3639e99a890852f8.js\",\"185\",\"static/chunks/app/layout-fc709578bf0ffcd4.js\"],\"GoogleTagManager\"]\n10:I[5404,[],\"\"]\n7:[\"slug\",\"nb-tf-text-classification\",\"d\"]\n11:[]\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/81c2358a4e4f0309.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L3\",null,{\"buildId\":\"ZLKuBxtPs8smtx1jEEZqR\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/nb-tf-text-classification\",\"initialTree\":[\"\",{\"children\":[\"(blog)\",{\"children\":[[\"slug\",\"nb-tf-text-classification\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"nb-tf-text-classification\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"(blog)\",{\"children\":[[\"slug\",\"nb-tf-text-classification\",\"d\"],{\"children\":[\"__PAGE__\",{},[\"$L4\",\"$L5\",null]]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(blog)\",\"children\",\"$7\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(blog)\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[null,[\"$\",\"html\",null,{\"lang\":\"ko\",\"className\":\"h-full scroll-smooth\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"$L9\",null,{\"id\":\"adsbygoogle-init\",\"strategy\":\"beforeInteractive\",\"src\":\"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1154659137489563\",\"crossOrigin\":\"anonymous\"}]}],[\"$\",\"body\",null,{\"className\":\"flex min-h-screen flex-col font-pretendard\",\"children\":[[\"$\",\"$La\",null,{\"children\":[[\"$\",\"$Lb\",null,{}],[\"$\",\"main\",null,{\"className\":\"mt-[calc(64px+env(safe-area-inset-top))] flex flex-1 flex-col\",\"children\":[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"div\",null,{\"className\":\"grid flex-1 place-content-center text-center\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"mb-4 text-2xl font-bold\",\"children\":\"Not Found\"}],[\"$\",\"p\",null,{\"className\":\"mb-8 text-lg\",\"children\":\"찾을 수 없는 페이지입니다.\"}],[\"$\",\"$Lc\",null,{\"href\":\"/\",\"children\":\"홈으로\",\"className\":\"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 py-2 mx-auto w-fit px-10\"}]]}],\"notFoundStyles\":[],\"styles\":null}]}],[\"$\",\"footer\",null,{\"className\":\"mb-16 mt-20 flex flex-col items-center justify-center gap-4 text-center print:hidden\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex justify-center gap-4\",\"children\":[[\"$\",\"$Lc\",null,{\"href\":\"https://github.com/\",\"target\":\"_blank\",\"children\":[\"$\",\"svg\",null,{\"fill\":\"currentColor\",\"viewBox\":\"0 0 16 16\",\"height\":30,\"width\":30,\"className\":\"fill-foreground transition hover:fill-pink-600\",\"children\":[\"$\",\"path\",null,{\"d\":\"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0016 8c0-4.42-3.58-8-8-8z\"}]}]}],[\"$\",\"$Lc\",null,{\"href\":\"https://www.linkedin.com/in/\",\"target\":\"_blank\",\"children\":[\"$\",\"svg\",null,{\"viewBox\":\"0 0 24 24\",\"fill\":\"currentColor\",\"height\":30,\"width\":30,\"className\":\"fill-foreground transition hover:fill-pink-600\",\"children\":[\"$\",\"path\",null,{\"d\":\"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z\"}]}]}]]}],[\"$\",\"div\",null,{\"children\":[\"© 2024. \",[\"$\",\"span\",null,{\"className\":\"font-semibold\",\"children\":\"Devtimes\"}],\" all rights reserved.\"]}]]}]]}],[\"$\",\"$Ld\",null,{}],[\"$\",\"$Le\",null,{\"gtmId\":\"GTM-M5JW97ZQ\"}]]}]]}],null]],\"initialHead\":[false,\"$Lf\"],\"globalErrorComponent\":\"$10\",\"missingSlots\":\"$W11\"}]]\n"])</script><script>self.__next_f.push([1,"12:I[2465,[\"605\",\"static/chunks/605-9393b79bc12886be.js\",\"62\",\"static/chunks/62-85f1524ddbccd7d3.js\",\"206\",\"static/chunks/app/(blog)/%5Bslug%5D/page-c22a71244d371731.js\"],\"\"]\n14:I[3574,[\"605\",\"static/chunks/605-9393b79bc12886be.js\",\"62\",\"static/chunks/62-85f1524ddbccd7d3.js\",\"206\",\"static/chunks/app/(blog)/%5Bslug%5D/page-c22a71244d371731.js\"],\"\"]\n15:I[938,[\"605\",\"static/chunks/605-9393b79bc12886be.js\",\"62\",\"static/chunks/62-85f1524ddbccd7d3.js\",\"206\",\"static/chunks/app/(blog)/%5Bslug%5D/page-c22a71244d3717"])</script><script>self.__next_f.push([1,"31.js\"],\"\"]\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"className\":\"prose mx-auto w-full max-w-[750px] px-5 dark:prose-invert sm:px-6\",\"children\":[[\"$\",\"header\",null,{\"className\":\"mt-14 text-center\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"mb-5 text-3xl\",\"children\":\"TF - 텍스트 분류\"}],[\"$\",\"div\",null,{\"className\":\"mb-3 text-base\",\"children\":[\"$\",\"$Lc\",null,{\"href\":\"/ai\",\"className\":\"font-semibold text-pink-600 no-underline underline-offset-4 hover:underline\",\"children\":\"Ai\"}]}],[\"$\",\"div\",null,{\"className\":\"flex justify-center gap-3 text-sm text-gray-500 dark:text-gray-400\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex items-center gap-1\",\"children\":[[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-calendar-days w-3.5\",\"children\":[[\"$\",\"path\",\"1cmpym\",{\"d\":\"M8 2v4\"}],[\"$\",\"path\",\"4m81vk\",{\"d\":\"M16 2v4\"}],[\"$\",\"rect\",\"1hopcy\",{\"width\":\"18\",\"height\":\"18\",\"x\":\"3\",\"y\":\"4\",\"rx\":\"2\"}],[\"$\",\"path\",\"8toen8\",{\"d\":\"M3 10h18\"}],[\"$\",\"path\",\"6423bh\",{\"d\":\"M8 14h.01\"}],[\"$\",\"path\",\"1etili\",{\"d\":\"M12 14h.01\"}],[\"$\",\"path\",\"1gbofw\",{\"d\":\"M16 14h.01\"}],[\"$\",\"path\",\"lrp35t\",{\"d\":\"M8 18h.01\"}],[\"$\",\"path\",\"mhygvu\",{\"d\":\"M12 18h.01\"}],[\"$\",\"path\",\"kzsmim\",{\"d\":\"M16 18h.01\"}],\"$undefined\"]}],[\"$\",\"span\",null,{\"children\":\"2019년 08월 07일\"}]]}],[\"$\",\"div\",null,{\"className\":\"flex items-center gap-1\",\"children\":[[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-clock3 w-3.5\",\"children\":[[\"$\",\"circle\",\"1mglay\",{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}],[\"$\",\"polyline\",\"1aq6pp\",{\"points\":\"12 6 12 12 16.5 12\"}],\"$undefined\"]}],[\"$\",\"span\",null,{\"children\":[20,\"분\"]}]]}]]}],[\"$\",\"hr\",null,{\"className\":\"mt-5\"}]]}],[\"$\",\"nav\",null,{\"className\":\"xl:hidden\",\"children\":[[\"$\",\"h2\",null,{\"id\":\"table-of-contents-top\",\"children\":\"On this page\"}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",\"#text-classification\",{\"className\":\"my-0 py-1\",\"children\":[\"$\",\"$Lc\",null,{\"href\":\"#text-classification\",\"className\":\"underline-offset-4 hover:text-pink-600\",\"children\":\" Text Classification\"}]}],[\"$\",\"li\",\"#데이터-준비\",{\"className\":\"ml-4 my-0 py-1\",\"children\":[\"$\",\"$Lc\",null,{\"href\":\"#데이터-준비\",\"className\":\"underline-offset-4 hover:text-pink-600\",\"children\":\" 데이터 준비\"}]}],[\"$\",\"li\",\"#decode-example\",{\"className\":\"my-0 py-1\",\"children\":[\"$\",\"$Lc\",null,{\"href\":\"#decode-example\",\"className\":\"underline-offset-4 hover:text-pink-600\",\"children\":\" decode example\"}]}],[\"$\",\"li\",\"#데이터-전치리\",{\"className\":\"my-0 py-1\",\"children\":[\"$\",\"$Lc\",null,{\"href\":\"#데이터-전치리\",\"className\":\"underline-offset-4 hover:text-pink-600\",\"children\":\" 데이터 전치리\"}]}],[\"$\",\"li\",\"#모델-구성하기\",{\"className\":\"my-0 py-1\",\"children\":[\"$\",\"$Lc\",null,{\"href\":\"#모델-구성하기\",\"className\":\"underline-offset-4 hover:text-pink-600\",\"children\":\" 모델 구성하기\"}]}],[\"$\",\"li\",\"#모델-훈련하기\",{\"className\":\"my-0 py-1\",\"children\":[\"$\",\"$Lc\",null,{\"href\":\"#모델-훈련하기\",\"className\":\"underline-offset-4 hover:text-pink-600\",\"children\":\" 모델 훈련하기\"}]}],[\"$\",\"li\",\"#정확도와-손실-그래프-그리기\",{\"className\":\"my-0 py-1\",\"children\":[\"$\",\"$Lc\",null,{\"href\":\"#정확도와-손실-그래프-그리기\",\"className\":\"underline-offset-4 hover:text-pink-600\",\"children\":\" 정확도와 손실 그래프 그리기\"}]}]]}],[\"$\",\"hr\",null,{}]]}],[\"$\",\"article\",null,{\"className\":\"relative\",\"children\":[[\"$\",\"$L12\",null,{\"toc\":[{\"text\":\" Text Classification\",\"link\":\"#text-classification\",\"indent\":0},{\"text\":\" 데이터 준비\",\"link\":\"#데이터-준비\",\"indent\":1},{\"text\":\" decode example\",\"link\":\"#decode-example\",\"indent\":0},{\"text\":\" 데이터 전치리\",\"link\":\"#데이터-전치리\",\"indent\":0},{\"text\":\" 모델 구성하기\",\"link\":\"#모델-구성하기\",\"indent\":0},{\"text\":\" 모델 훈련하기\",\"link\":\"#모델-훈련하기\",\"indent\":0},{\"text\":\" 정확도와 손실 그래프 그리기\",\"link\":\"#정확도와-손실-그래프-그리기\",\"indent\":0}]}],\"$L13\"]}],[\"$\",\"hr\",null,{}],[\"$\",\"$L14\",null,{}],[\"$\",\"$L15\",null,{}]]}]\n"])</script><script>self.__next_f.push([1,"f:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1, viewport-fit=cover\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"TF - 텍스트 분류 | DevTimes\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"TF - 텍스트 분류\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:title\",\"content\":\"TF - 텍스트 분류 | DevTimes\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:description\",\"content\":\"TF - 텍스트 분류\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:url\",\"content\":\"https://devtimes.com/nb-tf-text-classification\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:image\",\"content\":\"https://devtimes.com/posts/ai/nb-tf-text-classification/cover.png\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"9\",{\"property\":\"article:published_time\",\"content\":\"2019-08-07T00:00:00.000Z\"}],[\"$\",\"meta\",\"10\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:title\",\"content\":\"TF - 텍스트 분류 | DevTimes\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:description\",\"content\":\"TF - 텍스트 분류\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:image\",\"content\":\"https://devtimes.com/posts/ai/nb-tf-text-classification/cover.png\"}],[\"$\",\"link\",\"14\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"518x518\"}],[\"$\",\"link\",\"15\",{\"rel\":\"icon\",\"href\":\"/icon.png?8d4a794a4e2a4e0b\",\"type\":\"image/png\",\"sizes\":\"518x518\"}],[\"$\",\"link\",\"16\",{\"rel\":\"apple-touch-icon\",\"href\":\"/apple-icon.png?8d4a794a4e2a4e0b\",\"type\":\"image/png\",\"sizes\":\"518x518\"}]]\n"])</script><script>self.__next_f.push([1,"4:null\n"])</script><script>self.__next_f.push([1,"16:T47d,"])</script><script>self.__next_f.push([1,"    \"\u003cSTART\u003e this film was just brilliant casting location scenery story direction everyone's really suited the part they played and you could just imagine being there robert \u003cUNK\u003e is an amazing actor and now the same being director \u003cUNK\u003e father came from the same scottish island as myself so i loved the fact there was a real connection with this film the witty remarks throughout the film were great it was just brilliant so much that i bought the film as soon as it was released for \u003cUNK\u003e and would recommend it to everyone to watch and the fly fishing was amazing really cried at the end it was so sad and you know what they say if you cry at a film it must have been good and this definitely was also \u003cUNK\u003e to the two little boy's that played the \u003cUNK\u003e of norman and paul they were just brilliant children are often left out of the \u003cUNK\u003e list i think because the stars that play them all grown up are such a big profile for the whole film but these children are amazing and should be praised for what they have done don't you think the whole story was so lovely because it was true and was someone's life after all that was shared with us all\""])</script><script>self.__next_f.push([1,"13:[[\"$\",\"p\",null,{\"children\":\"지난번에 TF-IDF 및 Word2Vec을 이용해 텍스트를 분류해 보았다. 이번에는 텐서플로를 이용하여 텍스트를 분류 해보자.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"여기에서는 인터넷 영화 데이터베이스(Internet Movie Database)에서 수집한 50,000개의 영화 리뷰 텍스트를 담은 IMDB 데이터셋을 사용하겠다. 25,000개 리뷰는 훈련용으로, 25,000개는 테스트용으로 나뉘어져 있고, 훈련 세트와 테스트 세트의 클래스는 균형이 잡혀 있다. 즉 긍정적인 리뷰와 부정적인 리뷰의 개수가 동일하다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"데이터는 Keras에서 제공하는 datasets를 이용하여 다운로드 하자.\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"text-classification\",\"children\":\"Text Classification\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"target\":\"_blank\",\"href\":\"https://www.tensorflow.org/tutorials/keras/basic_text_classification?hl=ko\",\"className\":\"break-words text-pink-600 no-underline underline-offset-4 hover:underline\",\"children\":\"https://www.tensorflow.org/tutorials/keras/basic_text_classification?hl=ko\"}]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" __future__\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\" import\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" absolute_import, division, print_function, unicode_literals, unicode_literals\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" tensorflow \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" tf\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" tensorflow \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" keras\"}]]}]]}]}]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" numpy \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" np\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"print\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(tf.\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"__version__\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"print\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(np.\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"__version__\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"1.13.1\",[\"$\",\"br\",null,{}],\"\\n\",\"1.16.2\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"만약 numpy 버전이 1.16.2 이상의 버전이라면 삭제 후 버전을 지정하여 설치를 해야 한다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"(imdb.load_data를 하는 도중 오류 발생)\"}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"my-6 flex items-center gap-3 rounded-md px-5 py-4 text-secondary-foreground bg-secondary\",\"children\":[false,[\"$\",\"div\",null,{\"className\":\"callout-contents flex-1\",\"children\":[\"$undefined\",[\"\\n\",[\"$\",\"p\",null,{\"children\":\"conda install numpy=1.16.2\"}],\"\\n\"]]}]]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"데이터-준비\",\"children\":\"데이터 준비\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"keras dataset에 있는 imdb를 사용한다.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"train과 test 데이터 셋은 각각 25,000개 이며 데이터는 review 자체로 구성\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"labels는 0또는 1값으로 긍정 부정을 나타냄\"}],\"\\n\"]}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"my-6 flex items-center gap-3 rounded-md px-5 py-4 text-secondary-foreground bg-secondary\",\"children\":[false,[\"$\",\"div\",null,{\"className\":\"callout-contents flex-1\",\"children\":[\"$undefined\",[\"\\n\",[\"$\",\"p\",null,{\"children\":\"test데이터를 이용하여 해당 Review가 영화에 대해 긍정 또는 부정적인지를 예측해 본다.\"}],\"\\n\"]]}]]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"imdb \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" keras.datasets.imdb\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(train_data, train_labels), (test_data, test_labels) \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" imdb.load_data(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"num_words\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"10000\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}]]}]}]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"print\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"\\\"훈련 샘플: \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#005CC5\"},\"children\":\"{}\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\", 레이블: \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#005CC5\"},\"children\":\"{}\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\".format(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"len\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(train_data), \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"len\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(train_labels)))\"}]]}]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"훈련 샘플: 25000, 레이블: 25000\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"실제 데이터를 살펴보면 문자가 아닌 숫자 값이 리스트로 들어있다.\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"print\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(train_data[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"])\"}]]}]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"[1, 14, 22, 16, 43, 530, 973, 1622, 1385, 65, 458, 4468, 66, 3941, 4, 173, 36, 256, 5, 25, 100, 43, 838, 112, 50, 670, 2, 9, 35, 480, 284, 5, 150, 4, 172, 112, 167, 2, 336, 385, 39, 4, 172, 4536, 1111, 17, 546, 38, 13, 447, 4, 192, 50, 16, 6, 147, 2025, 19, 14, 22, 4, 1920, 4613, 469, 4, 22, 71, 87, 12, 16, 43, 530, 38, 76, 15, 13, 1247, 4, 22, 17, 515, 17, 12, 16, 626, 18, 2, 5, 62, 386, 12, 8, 316, 8, 106, 5, 4, 2223, 5244, 16, 480, 66, 3785, 33, 4, 130, 12, 16, 38, 619, 5, 25, 124, 51, 36, 135, 48, 25, 1415, 33, 6, 22, 12, 215, 28, 77, 52, 5, 14, 407, 16, 82, 2, 8, 4, 107, 117, 5952, 15, 256, 4, 2, 7, 3766, 5, 723, 36, 71, 43, 530, 476, 26, 400, 317, 46, 7, 4, 2, 1029, 13, 104, 88, 4, 381, 15, 297, 98, 32, 2071, 56, 26, 141, 6, 194, 7486, 18, 4, 226, 22, 21, 134, 476, 26, 480, 5, 144, 30, 5535, 18, 51, 36, 28, 224, 92, 25, 104, 4, 226, 65, 16, 38, 1334, 88, 12, 16, 283, 5, 16, 4472, 113, 103, 32, 15, 16, 5345, 19, 178, 32]\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이렇게 되어 있는 이유는 추가적인 dictionary에 각 숫자와 단어가 매칭되어 있기 때문이다. 또한 아래와 같이 각각의 데이터 길이도 다른것을 확인 할 수 있다.\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"len\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(train_data[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"]), \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"len\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(train_data[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"])\"}]]}]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"(218, 189)\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"하지만 실제로 ML모델에 넣어줄때는 입력 길이는 모두 같아야 한다. 따라서 입력길이를 모두 동일하게 해주는 작업이 필요하다. 먼저 데이터를 보다 자세히 확인해보기 위해 각 데이터의 숫자를 단어로 치환해 보자.\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#768390\",\"--shiki-light\":\"#6A737D\"},\"children\":\"# 숫자로 된 값을 단어로 바꾸기 위한 dictionary를 가져온다.\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"word_index \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" imdb.get_word_index()\"}]]}]]}]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"word_index\"}],\"\\n\"]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"json\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"json\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"{\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#FF938A\",\"--shiki-light\":\"#B31D28\",\"--shiki-dark-font-style\":\"italic\",\"--shiki-light-font-style\":\"italic\"},\"children\":\" 'fawn'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"34701\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#FF938A\",\"--shiki-light\":\"#B31D28\",\"--shiki-dark-font-style\":\"italic\",\"--shiki-light-font-style\":\"italic\"},\"children\":\" 'tsukino'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"52006\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#FF938A\",\"--shiki-light\":\"#B31D28\",\"--shiki-dark-font-style\":\"italic\",\"--shiki-light-font-style\":\"italic\"},\"children\":\" 'nunnery'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"52007\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#FF938A\",\"--shiki-light\":\"#B31D28\",\"--shiki-dark-font-style\":\"italic\",\"--shiki-light-font-style\":\"italic\"},\"children\":\" 'sonja'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"16816\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#FF938A\",\"--shiki-light\":\"#B31D28\",\"--shiki-dark-font-style\":\"italic\",\"--shiki-light-font-style\":\"italic\"},\"children\":\" 'vani'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"63951\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#FF938A\",\"--shiki-light\":\"#B31D28\",\"--shiki-dark-font-style\":\"italic\",\"--shiki-light-font-style\":\"italic\"},\"children\":\" 'woods'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"1408\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#FF938A\",\"--shiki-light\":\"#B31D28\",\"--shiki-dark-font-style\":\"italic\",\"--shiki-light-font-style\":\"italic\"},\"children\":\" ...\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"word_index.items()\"}],\"\\n\"]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"shell\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"shell\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" dict_items([(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'fawn'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"34701\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"), (\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'tsukino'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"52006\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"), \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'nunnery'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"52007\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"), (\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'sonja'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"16816\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"), \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'vani'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"63951\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"), (\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'woods'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"1408\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"), \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'spiders'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"16115\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\") ,,,\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"pad, start, unknown, unused 값을 나타내기 위해 각 value에 3을 더하고 비어있게 되는 0~3에 각각을 할당한다.\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#768390\",\"--shiki-light\":\"#6A737D\"},\"children\":\"# 처음 몇 개 인덱스는 사전에 정의되어 있습니다\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"word_index \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" {k:(v\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"3\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"for\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" k,v \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" word_index.items()} \"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"word_index[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"\\\"\u003cPAD\u003e\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" 0\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"word_index[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"\\\"\u003cSTART\u003e\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" 1\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"word_index[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"\\\"\u003cUNK\u003e\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" 2\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#768390\",\"--shiki-light\":\"#6A737D\"},\"children\":\"  # unknown\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"word_index[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"\\\"\u003cUNUSED\u003e\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"] \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" 3\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"reverse_word_index \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" dict\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"([(value, key) \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"for\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" (key, value) \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" word_index.items()])\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"def\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#DCBDFB\",\"--shiki-light\":\"#6F42C1\"},\"children\":\" decode_review\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(text):\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\" ' '\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\".join([reverse_word_index.get(i, \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'\u003c'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"str\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(i)\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'\u003e?'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"for\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" i \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"in\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" text])\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"실제로 필요한 dictionary는 숫자가 key이고, 단어가 value인 dictionary이기 때문에 reverse_word_index라는 dictionary를 구성하고 숫자로 이루어진 입력데이터를 단어로 치환해 주며 문장으로 출력하는 \",[\"$\",\"strong\",null,{\"children\":\"decode_review\"}],\" 함수를 만든다.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"decode-example\",\"children\":\"decode example\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"shell\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"shell\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#6F42C1\"},\"children\":\"-\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" [1,14,22,16,43,530...] =\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\" \\\"\u003cSTART\u003e \u003c14\u003e? \u003c22\u003e? \u003c16\u003e? film flick...\\\"\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#6F42C1\"},\"children\":\"-\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" 1\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\" :\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\" `\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"START\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"`\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#6F42C1\"},\"children\":\"-\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" 14\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" 22\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" 16\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\" :\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\" unknown\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#6F42C1\"},\"children\":\"-\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" 43\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\" :\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\" film\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#6F42C1\"},\"children\":\"-\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" 530\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\" :\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\" flick\"}]]}]]}]}]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"decode_review(train_data[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"])\"}]]}]}]}]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"shell\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"shell\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#6F42C1\"},\"children\":\"$16\"}]}]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"앞서 추가해주었던 \",[\"$\",\"code\",null,{\"children\":\"START\"}],\", \",[\"$\",\"code\",null,{\"children\":\"UNK\"}],\" 등이 추가되어 보여지는 것을 확인할 수 있다.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"데이터-전치리\",\"children\":\"데이터 전치리\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"위에서 언급했던 각 데이터의 길이가 상이한 것을 처리한다. keras에서 제공하는 preprocessing 함수를 이용하여 모든 데이터를 최대길이로 늘려주면서 빈공간에는 위에서 dictionary에 추가적으로 넣어주었던 pad값을 이용한다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"신경망에 주입하기 전에 텐서로 변환되어야 하는데, 변환하는 방법에는 몇 가지가 있다.\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"원-핫 인코딩(one-hot encoding) : 정수 배열을 0과 1로 이루어진 벡터로 변환한다. 예를 들어 배열 [3, 5]을 인덱스 3과 5만 1이고 나머지는 모두 0인 10,000차원 벡터로 변환할 수 있다. 그다음 실수 벡터 데이터를 다룰 수 있는 층-Dense 층-을 신경망의 첫 번째 층으로 사용한다. 이 방법은 num_words * num_reviews 크기의 행렬이 필요하기 때문에 메모리를 많이 사용하게 된다는 단점이 있다.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"다른 방법으로는, 정수 배열의 길이가 모두 같도록 패딩(padding)을 추가해 max_length * num_reviews 크기의 정수 텐서를 만드는 방법이다. 이런 형태의 텐서를 다룰 수 있는 임베딩(embedding) 층을 신경망의 첫 번째 층으로 사용할 수 있다.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"여기서는 두 번째 방식을 사용해보자.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"영화 리뷰의 길이가 같아야 하므로 \",[\"$\",\"strong\",null,{\"children\":\"pad_sequences\"}],\" 함수를 사용해 길이를 맞추자.\"]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"train_data \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" keras.preprocessing.sequence.pad_sequences(train_data,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"                                                        value\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"word_index[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"\\\"\u003cPAD\u003e\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"],\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"                                                        padding\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'post'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"                                                        maxlen\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"256\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"test_data \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" keras.preprocessing.sequence.pad_sequences(test_data,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"                                                        value\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"word_index[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"\\\"\u003cPAD\u003e\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"],\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"                                                        padding\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'post'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"                                                        maxlen\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"256\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이 작업을 통해 변경된 것을 확인해 보면,\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"train_data, test_data 길이가 동일\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"배열내 모든 데이터가 256\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"데이터 형태는 맨 뒤에 0값, 즉 pad값이 포함되어 있음\"}],\"\\n\"]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"len\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(train_data[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"]), \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"len\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(train_data[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"])\"}]]}]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"(256, 256)\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"print\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(train_data[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"0\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"])\"}]]}]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"[   1   14   22   16   43  530  973 1622 1385   65  458 4468   66 3941\",[\"$\",\"br\",null,{}],\"\\n\",\"4  173   36  256    5   25  100   43  838  112   50  670    2    9\",[\"$\",\"br\",null,{}],\"\\n\",\"35  480  284    5  150    4  172  112  167    2  336  385   39    4\",[\"$\",\"br\",null,{}],\"\\n\",\"172 4536 1111   17  546   38   13  447    4  192   50   16    6  147\",[\"$\",\"br\",null,{}],\"\\n\",\"2025   19   14   22    4 1920 4613  469    4   22   71   87   12   16\",[\"$\",\"br\",null,{}],\"\\n\",\"43  530   38   76   15   13 1247    4   22   17  515   17   12   16\",[\"$\",\"br\",null,{}],\"\\n\",\"626   18    2    5   62  386   12    8  316    8  106    5    4 2223\",[\"$\",\"br\",null,{}],\"\\n\",\"5244   16  480   66 3785   33    4  130   12   16   38  619    5   25\",[\"$\",\"br\",null,{}],\"\\n\",\"124   51   36  135   48   25 1415   33    6   22   12  215   28   77\",[\"$\",\"br\",null,{}],\"\\n\",\"52    5   14  407   16   82    2    8    4  107  117 5952   15  256\",[\"$\",\"br\",null,{}],\"\\n\",\"4    2    7 3766    5  723   36   71   43  530  476   26  400  317\",[\"$\",\"br\",null,{}],\"\\n\",\"46    7    4    2 1029   13  104   88    4  381   15  297   98   32\",[\"$\",\"br\",null,{}],\"\\n\",\"2071   56   26  141    6  194 7486   18    4  226   22   21  134  476\",[\"$\",\"br\",null,{}],\"\\n\",\"26  480    5  144   30 5535   18   51   36   28  224   92   25  104\",[\"$\",\"br\",null,{}],\"\\n\",\"4  226   65   16   38 1334   88   12   16  283    5   16 4472  113\",[\"$\",\"br\",null,{}],\"\\n\",\"103   32   15   16 5345   19  178   32    0    0    0    0    0    0\",[\"$\",\"br\",null,{}],\"\\n\",\"0    0    0    0    0    0    0    0    0    0    0    0    0    0\",[\"$\",\"br\",null,{}],\"\\n\",\"0    0    0    0    0    0    0    0    0    0    0    0    0    0\",[\"$\",\"br\",null,{}],\"\\n\",\"0    0    0    0]\"]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"모델-구성하기\",\"children\":\"모델 구성하기\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이제 text classification을 수행할 ML모델을 만들어보자.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"vocab_size는 영화리뷰에 사용되는 단어의 개수이다. 실제로 위에서 단어와 숫자를 매칭하는 dictionary의 사이즈 보다 크지만, 해당 데이터에서는 10000개의 단어 이내로 리뷰가 작성되었다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"각 레이어에 대한 설명은 다음과 같다.\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"embedding\"}],\" : 숫자로 인코딩 되어있는 각 단어를 사용하며 각 단어 인덱스에 대한 벡터를 찾는다. 이러한 데이터는 추후 모델이 핫습하는데 사용된다.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"GlobalAveragePooling1D\"}],\" : 각 예시에 대해 sequence 차원을 평균하여 고정된 길이의 벡터를 출력한다.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Dense\"}],\" : 첫번째 Dense 레이어를 통해서 고정길이로 출력된 vector값을 통해 16개의 hidden unit을 가진 fully-connected layer를 통과시킨다. 이후 두번째 Dense 레이어는 단일 출력 노드를 가지고 시그모이드 활성화 함수를 사용함으로써 결과에 대해 0~1 사이의 값을 가지도록 한다.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#768390\",\"--shiki-light\":\"#6A737D\"},\"children\":\"# 입력 크기는 영화 리뷰 데이터셋에 적용된 어휘 사전의 크기입니다(10,000개의 단어)\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"vocab_size \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" 10000\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"model \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" keras.Sequential()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"model.add(keras.layers.Embedding(vocab_size, \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"16\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"input_shape\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"None\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\",)))\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"model.add(keras.layers.GlobalAveragePooling1D())\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"model.add(keras.layers.Dense(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"16\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"activation\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"tf.nn.relu))\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"model.add(keras.layers.Dense(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"activation\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"tf.nn.sigmoid))\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"model.summary()\"}]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"layer-type-----------------output-shape--------------param-\",\"children\":\"Layer (type)                 Output Shape              Param #\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"embedding_2 (Embedding)      (None, None, 16)          160000\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"global_average_pooling1d_2 ( (None, 16)                0\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"dense_4 (Dense)              (None, 16)                272\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"dense_5-dense--------------none-1-----------------17\",\"children\":\"dense_5 (Dense)              (None, 1)                 17\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Total params: 160,289\",[\"$\",\"br\",null,{}],\"\\n\",\"Trainable params: 160,289\",[\"$\",\"br\",null,{}],\"\\n\",\"Non-trainable params: 0\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"모델 구성에 마지막으로 loss function과 optimizer를 설정한다.\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"model.compile(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"optimizer\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"tf.train.AdamOptimizer(),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"              loss\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'binary_crossentropy'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"              metrics\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'acc'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"])\"}]]}]]}]}]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"모델-훈련하기\",\"children\":\"모델 훈련하기\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"모델을 훈련하기에 앞서 10000개의 데이터를 분리하여 validation set을 만들자.\",[\"$\",\"br\",null,{}],\"\\n\",\"모델이 새롭게 접하는 데이터에 대한 accuracy와 loss등을 확인하기 위함이다.\"]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#768390\",\"--shiki-light\":\"#6A737D\"},\"children\":\"# 검증 세트 만들기\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"x_val \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" train_data[:\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"10000\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"partial_x_train \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" train_data[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"10000\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\":]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"y_val \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" train_labels[:\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"10000\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"partial_y_train \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" train_labels[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"10000\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\":]\"}]]}]]}]}]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#768390\",\"--shiki-light\":\"#6A737D\"},\"children\":\"# 모델 훈련\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"history \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" model.fit(partial_x_train,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"                    partial_y_train,\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"                    epochs\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"40\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"                    batch_size\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"512\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"                    validation_data\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(x_val, y_val),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"                    verbose\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Train on 15000 samples, validate on 10000 samples\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 1/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 99us/sample - loss: 0.6925 - acc: 0.5343 - val_loss: 0.6918 - val_acc: 0.5347\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 2/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 69us/sample - loss: 0.6899 - acc: 0.6281 - val_loss: 0.6880 - val_acc: 0.6741\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 3/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 70us/sample - loss: 0.6835 - acc: 0.7101 - val_loss: 0.6792 - val_acc: 0.7429\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 4/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 70us/sample - loss: 0.6699 - acc: 0.7408 - val_loss: 0.6623 - val_acc: 0.7469\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 5/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 71us/sample - loss: 0.6463 - acc: 0.7775 - val_loss: 0.6360 - val_acc: 0.7647\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 6/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 71us/sample - loss: 0.6127 - acc: 0.7950 - val_loss: 0.6017 - val_acc: 0.7821\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 7/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 71us/sample - loss: 0.5707 - acc: 0.8089 - val_loss: 0.5601 - val_acc: 0.7975\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 8/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 70us/sample - loss: 0.5240 - acc: 0.8279 - val_loss: 0.5180 - val_acc: 0.8142\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 9/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 72us/sample - loss: 0.4775 - acc: 0.8426 - val_loss: 0.4773 - val_acc: 0.8298\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 10/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 72us/sample - loss: 0.4343 - acc: 0.8581 - val_loss: 0.4416 - val_acc: 0.8392\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 11/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 72us/sample - loss: 0.3966 - acc: 0.8707 - val_loss: 0.4114 - val_acc: 0.8505\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 12/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 72us/sample - loss: 0.3645 - acc: 0.8798 - val_loss: 0.3880 - val_acc: 0.8537\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 13/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 71us/sample - loss: 0.3385 - acc: 0.8867 - val_loss: 0.3670 - val_acc: 0.8615\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 14/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 71us/sample - loss: 0.3154 - acc: 0.8932 - val_loss: 0.3519 - val_acc: 0.8651\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 15/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 71us/sample - loss: 0.2967 - acc: 0.8977 - val_loss: 0.3393 - val_acc: 0.8694\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 16/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 71us/sample - loss: 0.2800 - acc: 0.9027 - val_loss: 0.3290 - val_acc: 0.8711\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 17/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 72us/sample - loss: 0.2651 - acc: 0.9080 - val_loss: 0.3207 - val_acc: 0.8753\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 18/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 72us/sample - loss: 0.2519 - acc: 0.9119 - val_loss: 0.3132 - val_acc: 0.8780\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 19/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 72us/sample - loss: 0.2401 - acc: 0.9159 - val_loss: 0.3070 - val_acc: 0.8791\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 20/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 71us/sample - loss: 0.2295 - acc: 0.9203 - val_loss: 0.3029 - val_acc: 0.8798\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 21/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 72us/sample - loss: 0.2190 - acc: 0.9240 - val_loss: 0.2990 - val_acc: 0.8792\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 22/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 72us/sample - loss: 0.2101 - acc: 0.9261 - val_loss: 0.2951 - val_acc: 0.8828\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 23/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 72us/sample - loss: 0.2011 - acc: 0.9291 - val_loss: 0.2934 - val_acc: 0.8819\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 24/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 72us/sample - loss: 0.1933 - acc: 0.9325 - val_loss: 0.2905 - val_acc: 0.8837\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 25/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 71us/sample - loss: 0.1853 - acc: 0.9369 - val_loss: 0.2883 - val_acc: 0.8846\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 26/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 71us/sample - loss: 0.1783 - acc: 0.9395 - val_loss: 0.2880 - val_acc: 0.8839\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 27/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 71us/sample - loss: 0.1715 - acc: 0.9435 - val_loss: 0.2868 - val_acc: 0.8846\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 28/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 71us/sample - loss: 0.1650 - acc: 0.9460 - val_loss: 0.2861 - val_acc: 0.8845\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 29/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 71us/sample - loss: 0.1596 - acc: 0.9487 - val_loss: 0.2868 - val_acc: 0.8839\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 30/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 71us/sample - loss: 0.1537 - acc: 0.9511 - val_loss: 0.2859 - val_acc: 0.8855\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 31/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 71us/sample - loss: 0.1477 - acc: 0.9538 - val_loss: 0.2861 - val_acc: 0.8857\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 32/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 70us/sample - loss: 0.1423 - acc: 0.9558 - val_loss: 0.2867 - val_acc: 0.8857\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 33/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 70us/sample - loss: 0.1370 - acc: 0.9571 - val_loss: 0.2882 - val_acc: 0.8858\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 34/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 70us/sample - loss: 0.1324 - acc: 0.9605 - val_loss: 0.2892 - val_acc: 0.8868\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 35/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 70us/sample - loss: 0.1282 - acc: 0.9607 - val_loss: 0.2907 - val_acc: 0.8871\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 36/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 70us/sample - loss: 0.1234 - acc: 0.9636 - val_loss: 0.2923 - val_acc: 0.8866\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 37/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 70us/sample - loss: 0.1189 - acc: 0.9657 - val_loss: 0.2941 - val_acc: 0.8860\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 38/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 70us/sample - loss: 0.1148 - acc: 0.9671 - val_loss: 0.2968 - val_acc: 0.8852\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 39/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 70us/sample - loss: 0.1113 - acc: 0.9683 - val_loss: 0.2990 - val_acc: 0.8846\",[\"$\",\"br\",null,{}],\"\\n\",\"Epoch 40/40\",[\"$\",\"br\",null,{}],\"\\n\",\"15000/15000 [==============================] - 1s 71us/sample - loss: 0.1073 - acc: 0.9699 - val_loss: 0.3009 - val_acc: 0.8841\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Epoch 1에서 40까지 진행이 되고 해당 Epoch에서의 acc 및 loss를 확인할 수 있다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이제 모델 평가 결과를 확인해 보자.\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"results \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" model.evaluate(test_data, test_labels)\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"print\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(results)\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"25000/25000 [==============================] - 1s 21us/sample - loss: 0.3204 - acc: 0.8736\",[\"$\",\"br\",null,{}],\"\\n\",\"[0.3203906687307358, 0.8736]\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"실제로 더 진보된 모델이라고 하기 위해서는 약 95% 이상의 정확도를 필요로 한다. 하지만 매우 단순한 방식을 사용했기 때문에 약 87% 정도의 정확도를 달성한 것을 확인 할 수 있다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"결과를 정확도와 오차의 그래프로 확인해 보자.\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"정확도와-손실-그래프-그리기\",\"children\":\"정확도와 손실 그래프 그리기\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"model.fit()\"}],\"은 History 객체를 반환한다. 여기에는 훈련하는 동안 일어난 모든 정보가 dictionary로 담겨 있다.\"]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"history_dict \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" history.history\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"history_dict.keys()\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"dict_keys(['loss', 'acc', 'val_loss', 'val_acc'])\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"키를 확인해 보면 네개의 항목이 있다. 이는 훈련과 검증 단계에서 모니터링하는 지표들이다. 훈련 손실과 검증 손실을 그래프로 그려 보고, 훈련 정확도와 검증 정확도도 그래프로 그려 비교해 보자.\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" matplotlib.pyplot \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"as\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" plt\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"acc \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" history_dict[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'acc'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"val_acc \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" history_dict[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'val_acc'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"loss \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" history_dict[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'loss'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"val_loss \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\" history_dict[\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'val_loss'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"epochs \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" range\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\"len\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"(acc) \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"+\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#6CB6FF\",\"--shiki-light\":\"#005CC5\"},\"children\":\" 1\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#768390\",\"--shiki-light\":\"#6A737D\"},\"children\":\"# 'bo'는 파란색점, 'b'는 파란 실선\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"plt.plot(epochs, loss, \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'bo'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"label\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'Training loss'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"plt.plot(epochs, val_loss, \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'b'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"label\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'Validation loss'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"plt.title(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'Training and validation loss'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"plt.xlabel(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'Epochs'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"plt.ylabel(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'Loss'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"plt.legend()\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"plt.show()\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"img\",null,{\"src\":\"/posts/ai/nb-tf-text-classification/output_39_0.png\",\"alt\":\"png\",\"className\":\"mx-auto mb-0 mt-8 rounded-md\"}],[\"$\",\"span\",null,{\"className\":\"mb-8 mt-2 block w-full text-center text-sm text-gray-500 dark:text-gray-400\",\"children\":\"png\"}]]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-dark\":\"#adbac7\",\"--shiki-light\":\"#24292e\",\"--shiki-dark-bg\":\"#22272e\",\"--shiki-light-bg\":\"#fff\"},\"tabIndex\":\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"python\",\"data-theme\":\"github-dark-dimmed github-light\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"plt.clf()   \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#768390\",\"--shiki-light\":\"#6A737D\"},\"children\":\"# 그림을 초기화합니다\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"plt.plot(epochs, acc, \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'bo'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"label\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'Training acc'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"plt.plot(epochs, val_acc, \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'b'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F69D50\",\"--shiki-light\":\"#E36209\"},\"children\":\"label\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#F47067\",\"--shiki-light\":\"#D73A49\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'Validation acc'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"plt.title(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'Training and validation accuracy'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"plt.xlabel(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'Epochs'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"plt.ylabel(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#96D0FF\",\"--shiki-light\":\"#032F62\"},\"children\":\"'Accuracy'\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"plt.legend()\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-dark\":\"#ADBAC7\",\"--shiki-light\":\"#24292E\"},\"children\":\"plt.show()\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"img\",null,{\"src\":\"/posts/ai/nb-tf-text-classification/output_40_0.png\",\"alt\":\"png\",\"className\":\"mx-auto mb-0 mt-8 rounded-md\"}],[\"$\",\"span\",null,{\"className\":\"mb-8 mt-2 block w-full text-center text-sm text-gray-500 dark:text-gray-400\",\"children\":\"png\"}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"점선은 훈련 loss와 accuracy이고 실선은 검증 loss와 accuracy를 나타낸다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"훈련(점선)에서 loss는 epoch가 진행되면서 감소하고 accuracy는 증가한다. 하지만 검증(실선)에서는 약 20번째 epoch 이후가 최적점인 것 같다. 이는 훈련 데이터에서만 잘 동작하는 과대적합 때문일 것이다. 이 지점 부터는 모델이 과도하게 최적화되어 테스트 데이터에서 일반화되기 어려운 훈련 데이터 특정 표현을 학습하게 된다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"여기에서는 과대적합을 막기 위해 단순히 20번째 epoch 근처에서 훈련을 멈출 수 있다.\"}]]\n"])</script><script>self.__next_f.push([1,""])</script></body></html>